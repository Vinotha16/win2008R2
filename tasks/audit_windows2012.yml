---
####AUDIT####
  - name: Creating the custom_facts and facts directory
    win_file:
      path: '{{item}}'
      state: directory
    with_items:
      - 'c:\custom_facts'
      - 'c:\facts'
    tags:
      - audit

  - name: copying the jinjatemplate and audit zip
    win_copy:
      src: '{{ item.src }}'
      dest:  '{{ item.dest }}'
    with_items:
      - { src: '../templates/windows_jinjatemplate_audit_actual/windows2012nonr2/dc/windows2012nonr2.j2.ps1', dest: 'c:\custom_facts\' }
      - { src: '../templates/windows_jinjatemplate_audit_actual/windows2012nonr2/dc/audit.zip', dest: 'c:\facts\' }
    when: (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audit

  - name: copying the jinjatemplate and audit zip
    win_copy:
      src: '{{ item.src }}'
      dest:  '{{ item.dest }}'
    with_items:
      - { src: '../templates/windows_jinjatemplate_audit_actual/windows2012nonr2/ms/windows2012nonr2.j2.ps1', dest: 'c:\custom_facts\' }
      - { src: '../templates/windows_jinjatemplate_audit_actual/windows2012nonr2/ms/audit.zip', dest: 'c:\facts\' }
    when: (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - audit

  - name: copying the jinjatemplate and audit zip
    win_copy:
      src: '{{ item.src }}'
      dest:  '{{ item.dest }}'
    with_items:
      - { src: '../templates/windows_jinjatemplate_audit_actual/windows2012nonr2/standalone/windows2012nonr2.j2.ps1', dest: 'c:\custom_facts\' }
      - { src: '../templates/windows_jinjatemplate_audit_actual/windows2012nonr2/standalone/audit.zip', dest: 'c:\facts\' }
    when: (ansible_windows_domain_role | regex_search('Stand-alone'))
    tags:
      - audit

  - name: unzipping the audit
    win_unzip:
      src: 'c:\facts\audit.zip'
      dest: 'c:\facts\'
      delete_archive: yes
    tags:
      - audit
      
  - name: Checking if jinjatemplate exists
    win_stat:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
    register: jinjawin
    tags:
      - always
      
  - name: Creating jinjatemplate
    win_file:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      state: touch
    when: jinjawin.stat.exists != true
    tags:
      - always
      
  - name: Transfering enfpwdhist audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enfpwdhist_111_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - enfpwdhist
      - 1.1.1
      - one
      - all

  - name: Adding enfpwdhist into template
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENFPWDHIST = C:\facts\enfpwdhist_111_audit.ps1'
      - '"enfpwdhist_111_audit : $ENFPWDHIST"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - enfpwdhist
      - 1.1.1
      - one
      - all

  - name: Transfering maxpwdage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/maxpwdage_112_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - maxpwdage
      - 1.1.2
      - one
      - all

  - name: Adding maxpwdage into template
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MAXPWDAGE = C:\facts\maxpwdage_112_audit.ps1'
      - '"maxpwdage_112_audit : $MAXPWDAGE"'
    when: 
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - maxpwdage
      - 1.1.2
      - one
      - all

  - name: Transfering minpwdage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/minpwdage_113_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - minpwdage
      - 1.1.3
      - one
      - all

  - name: Adding minpwdage in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MINPWDAGE = C:\facts\minpwdage_113_audit.ps1'
      - '"minpwdage_113_audit : $MINPWDAGE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - minpwdage
      - 1.1.3
      - one
      - all

  - name: Transfering minpwdlen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/minpwdlen_114_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - minpwdlen
      - 1.1.4
      - one
      - all

  - name: Adding minpwdlen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MINPWDLEN = C:\facts\minpwdlen_114_audit.ps1'
      - '"minpwdlen_114_audit : $MINPWDLEN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - minpwdlen
      - 1.1.4
      - one
      - all

  - name: Transfering pwdcomplex audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdcomplex_115_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - pwdcomplex
      - 1.1.5
      - one
      - all

  - name: Adding pwdcomplex in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDCOMPLEX = C:\facts\pwdcomplex_115_audit.ps1'
      - '"pwdcomplex_115_audit : $PWDCOMPLEX"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - pwdcomplex
      - 1.1.5
      - one
      - all

  - name: Transfering reversepath audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/reversepath_116_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - reversepath
      - 1.1.6
      - one
      - all

  - name: Adding reversepath in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REVERSEPATH = C:\facts\reversepath_116_audit.ps1'
      - '"reversepath_116_audit : $REVERSEPATH"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - reversepath
      - 1.1.6
      - one
      - all

  - name: Transfering acclockdur audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/acclockdur_121_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - acclockdur
      - 1.2.1
      - one
      - all

  - name: Adding acclockdur in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ACCLOCKDUR = C:\facts\acclockdur_121_audit.ps1'
      - '"acclockdur_121_audit : $ACCLOCKDUR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - acclockdur
      - 1.2.1
      - one
      - all

  - name: Transfering acclockthres audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/acclockthres_122_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - acclockthres
      - 1.2.2
      - one
      - all

  - name: Adding acclockthres in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ACCLOCKTHRES = C:\facts\acclockthres_122_audit.ps1'
      - '"acclockthres_122_audit : $ACCLOCKTHRES"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - acclockthres
      - 1.2.2
      - one
      - all

  - name: Transfering resetacclock audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/resetacclock_123_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - resetacclock
      - 1.2.3
      - one
      - all

  - name: Adding resetacclock in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RESETACCLOCK = C:\facts\resetacclock_123_audit.ps1'
      - '"resetacclock_123_audit : $RESETACCLOCK"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - resetacclock
      - 1.2.3
      - one
      - all

  - name: Transfering accesscredmgr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/accesscredmgr_221_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - accesscredmgr
      - 2.2.1
      - two
      - all

  - name: Adding accesscredmgr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ACCESSCREDMGR = C:\facts\accesscredmgr_221_audit.ps1'
      - '"accesscredmgr_221_audit : $ACCESSCREDMGR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - accesscredmgr
      - 2.2.1
      - two
      - all

  - name: Transfering accesscompdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/accesscompdc_222_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'  
    tags:
      - accesscompdc
      - 2.2.2
      - two
      - all

  - name: Adding accesscompdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ACCESSCOMPDC = C:\facts\accesscompdc_222_audit.ps1'
      - '"accesscompdc_222_audit : $ACCESSCOMPDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'    
    tags:
      - accesscompdc
      - 2.2.2
      - two
      - all

  - name: Transfering accesscompms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/accesscompms_223_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'    
    tags:
      - accesscompms
      - 2.2.3
      - two
      - all

  - name: Adding accesscompms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ACCESSCOMPMS = C:\facts\accesscompms_223_audit.ps1'
      - '"accesscompms_223_audit : $ACCESSCOMPMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'    
    tags:
      - accesscompms
      - 2.2.3
      - two
      - all

  - name: Transfering actaspartoper audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/actaspartoper_224_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - actaspartoper
      - 2.2.4
      - two
      - all

  - name: Adding actaspartoper in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ACTASPARTOPER = C:\facts\actaspartoper_224_audit.ps1'
      - '"actaspartoper_224_audit : $ACTASPARTOPER"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - actaspartoper
      - 2.2.4
      - two
      - all

  - name: Transfering addwsdomain audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/addwsdomain_225_audit.ps1
      dest: c:\facts\
    when: 
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'    
    tags:
      - addwsdomain
      - 2.2.5
      - two
      - all

  - name: Adding addwsdomain in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ADDWSDOMAIN = C:\facts\addwsdomain_225_audit.ps1'
      - '"addwsdomain_225_audit : $ADDWSDOMAIN"'
    when: 
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'  
    tags:
      - addwsdomain
      - 2.2.5
      - two
      - all

  - name: Transfering memquotaprocess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/memquotaprocess_226_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2' 
    tags:
      - memquotaprocess
      - 2.2.6
      - two
      - all

  - name: Adding memquotaprocess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MEMQUOTAPROCESS = C:\facts\memquotaprocess_226_audit.ps1'
      - '"memquotaprocess_226_audit : $MEMQUOTAPROCESS"'
    when: 
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - memquotaprocess
      - 2.2.6
      - two
      - all

  - name: Transfering allowloglocal audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowloglocal_227_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowloglocal
      - 2.2.7
      - two
      - all

  - name: Adding allowloglocal in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWLOGLOCAL = C:\facts\allowloglocal_227_audit.ps1'
      - '"allowloglocal_227_audit : $ALLOWLOGLOCAL"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - allowloglocal
      - 2.2.7
      - two
      - all

  - name: Transfering allowlogremdeskdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowlogremdeskdc_228_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'    
    tags:
      - allowlogremdeskdc
      - 2.2.8
      - two
      - all

  - name: Adding allowlogremdeskdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWLOGREMDESKDC = C:\facts\allowlogremdeskdc_228_audit.ps1'
      - '"allowlogremdeskdc_228_audit : $ALLOWLOGREMDESKDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'    
    tags:
      - allowlogremdeskdc
      - 2.2.8
      - two
      - all

  - name: Transfering allowlogremdeskms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowlogremdeskms_229_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'    
    tags:
      - allowlogremdeskms
      - 2.2.9
      - two
      - all

  - name: Adding allowlogremdeskms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWLOGREMDESKMS = C:\facts\allowlogremdeskms_229_audit.ps1'
      - '"allowlogremdeskms_229_audit : $ALLOWLOGREMDESKMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'    
    tags:
      - allowlogremdeskms
      - 2.2.9
      - two
      - all

  - name: Transfering backupfiledirs audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/backupfiledirs_2210_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - backupfiledirs
      - 2.2.10
      - two
      - all

  - name: Adding backupfiledirs in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$BACKUPFILEDIRS = C:\facts\backupfiledirs_2210_audit.ps1'
      - '"backupfiledirs_2210_audit : $BACKUPFILEDIRS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - backupfiledirs
      - 2.2.10
      - two
      - all

  - name: Transfering chgsystime audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/chgsystime_2211_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - chgsystime
      - 2.2.11
      - two
      - all

  - name: Adding chgsystime in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CHGSYSTIME = C:\facts\chgsystime_2211_audit.ps1'
      - '"chgsystime_2211_audit : $CHGSYSTIME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - chgsystime
      - 2.2.11
      - two
      - all

  - name: Transfering chgtimezone audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/chgtimezone_2212_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - chgtimezone
      - 2.2.12
      - two
      - all

  - name: Adding chgtimezone in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CHGTIMEZONE = C:\facts\chgtimezone_2212_audit.ps1'
      - '"chgtimezone_2212_audit : $CHGTIMEZONE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - chgtimezone
      - 2.2.12
      - two
      - all

  - name: Transfering pagefile audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pagefile_2213_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - pagefile
      - 2.2.13
      - two
      - all

  - name: Adding pagefile in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PAGEFILE = C:\facts\pagefile_2213_audit.ps1'
      - '"pagefile_2213_audit : $PAGEFILE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - pagefile
      - 2.2.13
      - two
      - all

  - name: Transfering tokenobj audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/tokenobj_2214_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - tokenobj
      - 2.2.14
      - two
      - all

  - name: Adding tokenobj in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TOKENOBJ = C:\facts\tokenobj_2214_audit.ps1'
      - '"tokenobj_2214_audit : $TOKENOBJ"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - tokenobj
      - 2.2.14
      - two
      - all

  - name: Transfering globalobj audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/globalobj_2215_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - globalobj
      - 2.2.15
      - two
      - all

  - name: Adding globalobj in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$GLOBALOBJ = C:\facts\globalobj_2215_audit.ps1'
      - '"globalobj_2215_audit : $GLOBALOBJ"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - globalobj
      - 2.2.15
      - two
      - all

  - name: Transfering permsharedobj audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/permsharedobj_2216_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - permsharedobj
      - 2.2.16
      - two
      - all

  - name: Adding permsharedobj in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PERMSHAREDOBJ = C:\facts\permsharedobj_2216_audit.ps1'
      - '"permsharedobj_2216_audit : $PERMSHAREDOBJ"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - permsharedobj
      - 2.2.16
      - two
      - all

  - name: Transfering symboliclinksdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/symboliclinksdc_2217_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - symboliclinksdc
      - 2.2.17
      - two
      - all

  - name: Adding symboliclinksdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SYMBOLICLINKSDC = C:\facts\symboliclinksdc_2217_audit.ps1'
      - '"symboliclinksdc_2217_audit : $SYMBOLICLINKSDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - symboliclinksdc
      - 2.2.17
      - two
      - all

  - name: Transfering sysboliclinksms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/sysboliclinksms_2218_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - sysboliclinksms
      - 2.2.18
      - two
      - all

  - name: Adding sysboliclinksms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SYMBOLICLINKSMS = C:\facts\sysboliclinksms_2218_audit.ps1'
      - '"sysboliclinksms_2218_audit : $SYMBOLICLINKSMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - sysboliclinksms
      - 2.2.18
      - two
      - all

  - name: Transfering debugprog audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/debugprog_2219_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - debugprog
      - 2.2.19
      - two
      - all

  - name: Adding debugprog in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DEBUGPROG = C:\facts\debugprog_2219_audit.ps1'
      - '"debugprog_2219_audit : $DEBUGPROG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - debugprog
      - 2.2.19
      - two
      - all

  - name: Transfering denyaccessdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denyaccessdc_2220_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - denyaccessdc
      - 2.2.20
      - two
      - all

  - name: Adding denyaccessdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYACCESSDC = C:\facts\denyaccessdc_2220_audit.ps1'
      - '"denyaccessdc_2220_audit : $DENYACCESSDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - denyaccessdc
      - 2.2.20
      - two
      - all

  - name: Transfering denyaccessms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denyaccessms_2221_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - denyaccessms
      - 2.2.21
      - two
      - all

  - name: Adding denyaccessms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYACCESSMS = C:\facts\denyaccessms_2221_audit.ps1'
      - '"denyaccessms_2221_audit : $DENYACCESSMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - denyaccessms
      - 2.2.21
      - two
      - all

  - name: Transfering denylogbatchjob audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denylogbatchjob_2222_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - denylogbatchjob
      - 2.2.22
      - two
      - all

  - name: Adding denylogbatchjob in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYLOGBATCHJOB = C:\facts\denylogbatchjob_2222_audit.ps1'
      - '"denylogbatchjob_2222_audit : $DENYLOGBATCHJOB"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - denylogbatchjob
      - 2.2.22
      - two
      - all

  - name: Transfering denylogservice audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denylogservice_2223_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - denylogservice
      - 2.2.23
      - two
      - all

  - name: Adding denylogservice in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYLOGSERVICE = C:\facts\denylogservice_2223_audit.ps1'
      - '"denylogservice_2223_audit : $DENYLOGSERVICE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - denylogservice
      - 2.2.23
      - two
      - all

  - name: Transfering denyloglocally audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denyloglocally_2224_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - denyloglocally
      - 2.2.24
      - two
      - all

  - name: Adding denyloglocally in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYLOGLOCALLY = C:\facts\denyloglocally_2224_audit.ps1'
      - '"denyloglocally_2224_audit : $DENYLOGLOCALLY"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - denyloglocally
      - 2.2.24
      - two
      - all

  - name: Transfering denylogremdeskdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denylogremdeskdc_2225_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - denylogremdeskdc
      - 2.2.25
      - two
      - all

  - name: Adding denylogremdeskdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYLOGREMDESKDC = C:\facts\denylogremdeskdc_2225_audit.ps1'
      - '"denylogremdeskdc_2225_audit : $DENYLOGREMDESKDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - denylogremdeskdc
      - 2.2.25
      - two
      - all

  - name: Transfering denylogremdeskms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/denylogremdeskms_2226_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'   
    tags:
      - denylogremdeskms
      - 2.2.26
      - two
      - all

  - name: Adding denylogremdeskms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DENYLOGREMDESKMS = C:\facts\denylogremdeskms_2226_audit.ps1'
      - '"denylogremdeskms_2226_audit : $DENYLOGREMDESKMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'   
    tags:
      - denylogremdeskms
      - 2.2.26
      - two
      - all

  - name: Transfering enbcompusraccdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enbcompusraccdc_2227_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'   
    tags:
      - enbcompusraccdc
      - 2.2.27
      - two
      - all

  - name: Adding enbcompusraccdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENBCOMPUSRACCDC = C:\facts\enbcompusraccdc_2227_audit.ps1'
      - '"enbcompusraccdc_2227_audit : $ENBCOMPUSRACCDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'   
    tags:
      - enbcompusraccdc
      - 2.2.27
      - two
      - all

  - name: Transfering enbcompusraccms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enbcompusraccms_2228_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'   
    tags:
      - enbcompusraccms
      - 2.2.28
      - two
      - all

  - name: Adding enbcompusraccms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENCOMPUSRACCMS = C:\facts\enbcompusraccms_2228_audit.ps1'
      - '"enbcompusraccms_2228_audit : $ENCOMPUSRACCMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'   
    tags:
      - enbcompusraccms
      - 2.2.28
      - two
      - all

  - name: Transfering forceshutdown audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/forceshutdown_2229_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - forceshutdown
      - 2.2.29
      - two
      - all

  - name: Adding forceshutdown in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$FORCESHUTDOWN = C:\facts\forceshutdown_2229_audit.ps1'
      - '"forceshutdown_2229_audit : $FORCESHUTDOWN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - forceshutdown
      - 2.2.29
      - two
      - all

  - name: Transfering securityaudits audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/securityaudits_2230_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - securityaudits
      - 2.2.30
      - two
      - all

  - name: Adding securityaudits in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SECURITYAUDITS = C:\facts\securityaudits_2230_audit.ps1'
      - '"securityaudits_2230_audit : $SECURITYAUDITS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - securityaudits
      - 2.2.30
      - two
      - all

  - name: Transfering clientauthendc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/clientauthendc_2231_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - clientauthendc
      - 2.2.31
      - two
      - all

  - name: Adding clientauthendc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CLIENTAUTHENDC = C:\facts\clientauthendc_2231_audit.ps1'
      - '"clientauthendc_2231_audit : $CLIENTAUTHENDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - clientauthendc
      - 2.2.31
      - two
      - all

  - name: Transfering clientauthenms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/clientauthenms_2232_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - clientauthenms
      - 2.2.32
      - two
      - all

  - name: Adding clientauthenms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CLIENTAUTHENMS = C:\facts\clientauthenms_2232_audit.ps1'
      - '"clientauthenms_2232_audit : $CLIENTAUTHENMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - clientauthenms
      - 2.2.32
      - two
      - all

  - name: Transfering incschedprior audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/incschedprior_2233_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - incschedprior
      - 2.2.33
      - two
      - all

  - name: Adding incschedprior in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$INCSCHEDPRIOR = C:\facts\incschedprior_2233_audit.ps1'
      - '"incschedprior_2233_audit : $INCSCHEDPRIOR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - incschedprior
      - 2.2.33
      - two
      - all

  - name: Transfering loadunloaddevdriver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/loadunloaddevdriver_2234_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - loadunloaddevdriver
      - 2.2.34
      - two
      - all

  - name: Adding loadunloaddevdriver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOADUNLOADDEVDRIVER = C:\facts\loadunloaddevdriver_2234_audit.ps1'
      - '"loadunloaddevdriver_2234_audit : $LOADUNLOADDEVDRIVER"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - loadunloaddevdriver
      - 2.2.34
      - two
      - all

  - name: Transfering lockpagemem audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/lockpagemem_2235_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags: 
      - lockpagemem
      - 2.2.35
      - two
      - all

  - name: Adding lockpagemem in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOCKPAGEMEM = C:\facts\lockpagemem_2235_audit.ps1'
      - '"lockpagemem_2235_audit : $LOCKPAGEMEM"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'      
    tags:
      - lockpagemem
      - 2.2.35
      - two
      - all

  - name: Transfering logbatchjob audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/logbatchjob_2236_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' 
    tags:
      - logbatchjob
      - 2.2.36
      - two
      - all

  - name: Adding logbatchjob in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOGBATCHJOB = C:\facts\logbatchjob_2236_audit.ps1'
      - '"logbatchjob_2236_audit : $LOGBATCHJOB"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - logbatchjob
      - 2.2.36
      - two
      - all

  - name: Transfering audsecurlogdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audsecurlogdc_2237_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audsecurlogdc
      - 2.2.37
      - two
      - all

  - name: Adding audsecurlogdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDSECURLOGDC = C:\facts\audsecurlogdc_2237_audit.ps1'
      - '"audsecurlogdc_2237_audit : $AUDSECURLOGDC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audsecurlogdc
      - 2.2.37
      - two
      - all

  - name: Transfering audsecurlogms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audsecurlogms_2238_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - audsecurlogms
      - 2.2.38
      - two
      - all

  - name: Adding audsecurlogms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDSECURLOGMS = C:\facts\audsecurlogms_2238_audit.ps1'
      - '"audsecurlogms_2238_audit : $AUDSECURLOGMS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - audsecurlogms
      - 2.2.38
      - two
      - all

  - name: Transfering modobjlabel audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/modobjlabel_2239_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - modobjlabel
      - 2.2.39
      - two
      - all

  - name: Adding modobjlabel in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MODFIRMENV = C:\facts\modobjlabel_2239_audit.ps1'
      - '"modobjlabel_2239_audit : $MODFIRMENV"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - modobjlabel
      - 2.2.39
      - two
      - all

  - name: Transfering modfirmenv audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/modfirmenv_2240_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - modfirmenv
      - 2.2.40
      - two
      - all

  - name: Adding modfirmenv in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MODFIRMENV = C:\facts\modfirmenv_2240_audit.ps1'
      - '"modfirmenv_2240_audit : $MODFIRMENV"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - modfirmenv
      - 2.2.40
      - two
      - all

  - name: Transfering volmaintasks audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/volmaintasks_2241_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - volmaintasks
      - 2.2.41
      - two
      - all

  - name: Adding volmaintasks in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$VOLMAINTASKS = C:\facts\volmaintasks_2241_audit.ps1'
      - '"volmaintasks_2241_audit : $VOLMAINTASKS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - volmaintasks
      - 2.2.41
      - two
      - all

  - name: Transfering profsinglepro audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/profsinglepro_2242_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - profsinglepro
      - 2.2.42
      - two
      - all

  - name: Adding profsinglepro in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PROFSINGLEPO = C:\facts\profsinglepro_2242_audit.ps1'
      - '"profsinglepro_2242_audit : $PROFSINGLEPO"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - profsinglepro
      - 2.2.42
      - two
      - all

  - name: Transfering profsysperf audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/profsysperf_2243_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - profsysperf
      - 2.2.43
      - two
      - all

  - name: Adding profsysperf in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PROFSYSPERF = C:\facts\profsysperf_2243_audit.ps1'
      - '"profsysperf_2243_audit : $PROFSYSPERF"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - profsysperf
      - 2.2.43
      - two
      - all

  - name: Transfering replprotoken audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/replprotoken_2244_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - replprotoken
      - 2.2.44
      - two
      - all

  - name: Adding replprotoken in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REPLPROTAKEN = C:\facts\replprotoken_2244_audit.ps1'
      - '"replprotoken_2244_audit : $REPLPROTAKEN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - replprotoken
      - 2.2.44
      - two
      - all

  - name: Transfering restorefiledirs audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/restorefiledirs_2245_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - restorefiledirs
      - 2.2.45
      - two
      - all

  - name: Adding restorefiledirs in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RESTOREFILEDIRS = C:\facts\restorefiledirs_2245_audit.ps1'
      - '"restorefiledirs_2245_audit : $RESTOREFILEDIRS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - restorefiledirs
      - 2.2.45
      - two
      - all

  - name: Transfering shutdownsys audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/shutdownsys_2246_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - shutdownsys
      - 2.2.46
      - two
      - all

  - name: Adding shutdownsys in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SHUTDOWNSYS = C:\facts\shutdownsys_2246_audit.ps1'
      - '"shutdownsys_2246_audit : $SHUTDOWNSYS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - shutdownsys
      - 2.2.46
      - two
      - all

  - name: Transfering syncdirserdata audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/syncdirserdata_2247_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - syncdirserdata
      - 2.2.47
      - two
      - all

  - name: Adding syncdirserdata in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SYNCDIRSERDATA = C:\facts\syncdirserdata_2247_audit.ps1'
      - '"syncdirserdata_2247_audit : $SYNCDIRSERDATA"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - syncdirserdata
      - 2.2.47
      - two
      - all

  - name: Transfering ownershipfile audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/ownershipfile_2248_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - ownershipfile
      - 2.2.48
      - two
      - all

  - name: Adding ownershipfile in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$OWNERSHIPFILE = C:\facts\ownershipfile_2248_audit.ps1'
      - '"ownershipfile_2248_audit : $OWNERSHIPFILE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - ownershipfile
      - 2.2.48
      - two
      - all

  - name: Transfering admaccstat audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/admaccstat_2311_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - admaccstat
      - 2.3.1.1
      - two
      - all

  - name: Adding admaccstat in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ADMACCSTAT = C:\facts\admaccstat_2311_audit.ps1'
      - '"admaccstat_2311_audit : $ADMACCSTAT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - admaccstat
      - 2.3.1.1
      - two
      - all

  - name: Transfering blockmsacc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/blockmsacc_2312_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - blockmsacc
      - 2.3.1.2
      - two
      - all

  - name: Adding blockmsacc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$BLOCKMSACC = C:\facts\blockmsacc_2312_audit.ps1'
      - '"blockmsacc_2312_audit : $BLOCKMSACC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - blockmsacc
      - 2.3.1.2
      - two
      - all
      
  - name: Transfering guestaccstat audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/guestaccstat_2313_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - guestaccstat
      - 2.3.1.3
      - two
      - all

  - name: Adding guestaccstat in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$GUESTACCSTAT = C:\facts\guestaccstat_2313_audit.ps1'
      - '"guestaccstat_2313_audit : $GUESTACCSTAT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - guestaccstat
      - 2.3.1.3
      - two
      - all

  - name: Transfering limitlocaccuse audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/limitlocaccuse_2314_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - limitlocaccuse
      - 2.3.1.4
      - two
      - all

  - name: Adding limitlocaccuse in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LIMITLOCACCUSE = C:\facts\limitlocaccuse_2314_audit.ps1'
      - '"limitlocaccuse_2314_audit : $LIMITLOCACCUSE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - limitlocaccuse
      - 2.3.1.4
      - two
      - all

  - name: Transfering renameadmacc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/renameadmacc_2315_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - renameadmacc
      - 2.3.1.5
      - two
      - all

  - name: Adding renameadmacc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RENAMEADACC = C:\facts\renameadmacc_2315_audit.ps1'
      - '"renameadmacc_2315_audit : $RENAMEADACC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - renameadmacc
      - 2.3.1.5
      - two
      - all

  - name: Transfering renameguestacc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/renameguestacc_2316_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - renameguestacc
      - 2.3.1.6
      - two
      - all

  - name: Adding renameguestacc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RENAMEGUESTACC = C:\facts\renameguestacc_2316_audit.ps1'
      - '"renameguestacc_2316_audit : $RENAMEGUESTACC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - renameguestacc
      - 2.3.1.6
      - two
      - all

  - name: Transfering forceaudpolicy audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/forceaudpolicy_2321_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - forceaudpolicy
      - 2.3.2.1
      - two
      - all

  - name: Adding forceaudpolicy in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$FORCEAUDPOLICY = C:\facts\forceaudpolicy_2321_audit.ps1'
      - '"forceaudpolicy_2321_audit : $FORCEAUDPOLICY"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - forceaudpolicy
      - 2.3.2.1
      - two
      - all

  - name: Transfering sysshutdownsecuraud audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/sysshutdownsecuraud_2322_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - sysshutdownsecuraud
      - 2.3.2.2
      - two
      - all

  - name: Adding sysshutdownsecuraud in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SYSSHUTDOWNSECURAUD = C:\facts\sysshutdownsecuraud_2322_audit.ps1'
      - '"sysshutdownsecuraud_2322_audit : $SYSSHUTDOWNSECURAUD"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - sysshutdownsecuraud
      - 2.3.2.2
      - two
      - all

  - name: Transfering allowremovmedia audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowremovmedia_2341_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - allowremovmedia
      - 2.3.4.1
      - two
      - all

  - name: Adding allowremovmedia in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWREMOVMEDIA = C:\facts\allowremovmedia_2341_audit.ps1'
      - '"allowremovmedia_2341_audit : $ALLOWREMOVMEDIA"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - allowremovmedia
      - 2.3.4.1
      - two
      - all

  - name: Transfering preventusr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/preventusr_2342_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - preventusr
      - 2.3.4.2
      - two
      - all

  - name: Adding preventusr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVENTUSR = C:\facts\preventusr_2342_audit.ps1'
      - '"preventusr_2342_audit : $PREVENTUSR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - preventusr
      - 2.3.4.2
      - two
      - all

  - name: Transfering allowservschedtask audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowservschedtask_2351_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - allowservschedtask
      - 2.3.5.1
      - two
      - all

  - name: Adding allowservschedtask in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWSERVSCHEDTASK = C:\facts\allowservschedtask_2351_audit.ps1'
      - '"allowservschedtask_2351_audit : $ALLOWSERVSCHEDTASK"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - allowservschedtask
      - 2.3.5.1
      - two
      - all

  - name: Transfering ldapservsign audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/ldapservsign_2352_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - ldapservsign
      - 2.3.5.2
      - two
      - all

  - name: Adding ldapservsign in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LDAPSERVSIGN = C:\facts\ldapservsign_2352_audit.ps1'
      - '"ldapservsign_2352_audit : $LDAPSERVSIGN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - ldapservsign
      - 2.3.5.2
      - two
      - all

  - name: Transfering refusemachaccpwd audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/refusemachaccpwd_2353_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - refusemachaccpwd
      - 2.3.5.3
      - two
      - all

  - name: Adding refusemachaccpwd in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REFUSEMACHACCPWD = C:\facts\refusemachaccpwd_2353_audit.ps1'
      - '"refusemachaccpwd_2353_audit : $REFUSEMACHACCPWD"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - refusemachaccpwd
      - 2.3.5.3
      - two
      - all

  - name: Transfering digiencryptsign audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digiencryptsign_2361_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digiencryptsign
      - 2.3.6.1
      - two
      - all

  - name: Adding digiencryptsign in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGIENCRYPTSIGN = C:\facts\digiencryptsign_2361_audit.ps1'
      - '"digiencryptsign_2361_audit : $DIGIENCRYPTSIGN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digiencryptsign
      - 2.3.6.1
      - two
      - all

  - name: Transfering digiencrypsecdata audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digiencrypsecdata_2362_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digiencrypsecdata
      - 2.3.6.2
      - two
      - all

  - name: Adding digiencrypsecdata in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGIENCRYPSECDATA = C:\facts\digiencrypsecdata_2362_audit.ps1'
      - '"digiencrypsecdata_2362_audit : $DIGIENCRYPSECDATA"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digiencrypsecdata
      - 2.3.6.2
      - two
      - all

  - name: Transfering digisignsecdata audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digisignsecdata_2363_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignsecdata
      - 2.3.6.3
      - two
      - all

  - name: Adding digisignsecdata in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGISIGNSECDATA = C:\facts\digisignsecdata_2363_audit.ps1'
      - '"digisignsecdata_2363_audit : $DIGISIGNSECDATA"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignsecdata
      - 2.3.6.3
      - two
      - all

  - name: Transfering dismachaccpwdchg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dismachaccpwdchg_2364_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - dismachaccpwdchg
      - 2.3.6.4
      - two
      - all

  - name: Adding dismachaccpwdchg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISMACHACCPWDCHG = C:\facts\dismachaccpwdchg_2364_audit.ps1'
      - '"dismachaccpwdchg_2364_audit : $DISMACHACCPWDCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - dismachaccpwdchg
      - 2.3.6.4
      - two
      - all

  - name: Transfering maxmachaccpwdage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/maxmachaccpwdage_2365_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - maxmachaccpwdage
      - 2.3.6.5
      - two
      - all

  - name: Adding maxmachaccpwdage in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MAXMACHACCPWDAGE = C:\facts\maxmachaccpwdage_2365_audit.ps1'
      - '"maxmachaccpwdage_2365_audit : $MAXMACHACCPWDAGE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - maxmachaccpwdage
      - 2.3.6.5
      - two
      - all

  - name: Transfering reqsessionkey audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/reqsessionkey_2366_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - reqsessionkey
      - 2.3.6.6
      - two
      - all

  - name: Adding reqsessionkey in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REQSESSIONKEY = C:\facts\reqsessionkey_2366_audit.ps1'
      - '"reqsessionkey_2366_audit : $REQSESSIONKEY"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - reqsessionkey
      - 2.3.6.6
      - two
      - all

  - name: Transfering dontdisplastusrname audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontdisplastusrname_2371_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - dontdisplastusrname
      - 2.3.7.1
      - two
      - all

  - name: Adding dontdisplastusrname in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTDISPLASTUSRNAME = C:\facts\dontdisplastusrname_2371_audit.ps1'
      - '"dontdisplastusrname_2371_audit : $DONTDISPLASTUSRNAME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - dontdisplastusrname
      - 2.3.7.1
      - two
      - all

  - name: Transfering dontreqctrlaltdel audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontreqctrlaltdel_2372_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - dontreqctrlaltdel
      - 2.3.7.2
      - two
      - all

  - name: Adding dontreqctrlaltdel in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTREQCTRLALTDEL = C:\facts\dontreqctrlaltdel_2372_audit.ps1'
      - '"dontreqctrlaltdel_2372_audit : $DONTREQCTRLALTDEL"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - dontreqctrlaltdel
      - 2.3.7.2
      - two
      - all

  - name: Transfering machinactlimit audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/machinactlimit_2373_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - machinactlimit
      - 2.3.7.3
      - two
      - all

  - name: Adding machinactlimit in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MACHINACTLIMIT = C:\facts\machinactlimit_2373_audit.ps1'
      - '"machinactlimit_2373_audit : $MACHINACTLIMIT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - machinactlimit
      - 2.3.7.3
      - two
      - all
      
  - name: Transfering msgtextusr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/msgtextusr_2374_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - msgtextusr
      - 2.3.7.4
      - two
      - all

  - name: Adding msgtextusr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MSGTEXTUSR = C:\facts\msgtextusr_2374_audit.ps1'
      - '"msgtextusr_2374_audit : $MSGTEXTUSR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - msgtextusr
      - 2.3.7.4
      - two
      - all

  - name: Transfering msgtitleusr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/msgtitleusr_2375_audit.ps1
      dest: c:\facts\
    tags:
      - msgtitleusr
      - 2.3.7.5
      - two
      - all

  - name: Adding msgtitleusr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MSGTITLEUSR = C:\facts\msgtitleusr_2375_audit.ps1'
      - '"msgtitleusr_2375_audit : $MSGTITLEUSR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - msgtitleusr
      - 2.3.7.5
      - two
      - all

  - name: Transfering countprevlogons audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/countprevlogons_2376_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - countprevlogons
      - 2.3.7.6
      - two
      - all

  - name: Adding countprevlogons in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$COUNTPREVLOGONS = C:\facts\countprevlogons_2376_audit.ps1'
      - '"countprevlogons_2376_audit : $COUNTPREVLOGONS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - countprevlogons
      - 2.3.7.6
      - two
      - all

  - name: Transfering promptusrchgpwd audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/promptusrchgpwd_2377_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - promptusrchgpwd
      - 2.3.7.7
      - two
      - all

  - name: Adding promptusrchgpwd in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PROMPTUSRCHGPWD = C:\facts\promptusrchgpwd_2377_audit.ps1'
      - '"promptusrchgpwd_2377_audit : $PROMPTUSRCHGPWD"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - promptusrchgpwd
      - 2.3.7.7
      - two
      - all

  - name: Transfering dcauthenunlockws audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dcauthenunlockws_2378_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - dcauthenunlockws
      - 2.3.7.8
      - two
      - all

  - name: Adding dcauthenunlockws in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DCAUTHENUNLOCKWS = C:\facts\dcauthenunlockws_2378_audit.ps1'
      - '"dcauthenunlockws_2378_audit : $DCAUTHENUNLOCKWS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - dcauthenunlockws
      - 2.3.7.8
      - two
      - all

  - name: Transfering smartcardremoval audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/smartcardremoval_2379_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - smartcardremoval
      - 2.3.7.9
      - two
      - all

  - name: Adding smartcardremoval in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SMARTCARDREMOVAL = C:\facts\smartcardremoval_2379_audit.ps1'
      - '"smartcardremoval_2379_audit : $SMARTCARDREMOVAL"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - smartcardremoval
      - 2.3.7.9
      - two
      - all

  - name: Transfering digisignclient audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digisignclient_2381_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignclient
      - 2.3.8.1
      - two
      - all

  - name: Adding digisignclient in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGISIGNCLIENT = C:\facts\digisignclient_2381_audit.ps1'
      - '"digisignclient_2381_audit : $DIGISIGNCLIENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignclient
      - 2.3.8.1
      - two
      - all

  - name: Transfering digisignservagree audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digisignservagree_2382_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignservagree
      - 2.3.8.2
      - two
      - all

  - name: Adding digisignservagree in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGISIGNSERVAGREE = C:\facts\digisignservagree_2382_audit.ps1'
      - '"digisignservagree_2382_audit : $DIGISIGNSERVAGREE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignservagree
      - 2.3.8.2
      - two
      - all

  - name: Transfering sendunencryppwd audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/sendunencryppwd_2383_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - sendunencryppwd
      - 2.3.8.3
      - two
      - all

  - name: Adding sendunencryppwd in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SENDUNENCRYPPWD = C:\facts\sendunencryppwd_2383_audit.ps1'
      - '"sendunencryppwd_2383_audit : $SENDUNENCRYPPWD"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - sendunencryppwd
      - 2.3.8.3
      - two
      - all

  - name: Transfering setidletime audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/setidletime_2391_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - setidletime
      - 2.3.9.1
      - two
      - all

  - name: Adding setidletime in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SETIDLETIME = C:\facts\setidletime_2391_audit.ps1'
      - '"setidletime_2391_audit : $SETIDLETIME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - setidletime
      - 2.3.9.1
      - two
      - all

  - name: Transfering digisignserv audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digisignserv_2392_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignserv
      - 2.3.9.2
      - two
      - all

  - name: Adding digisignserv in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGISIGNSERV = C:\facts\digisignserv_2392_audit.ps1'
      - '"digisignserv_2392_audit : $DIGISIGNSERV"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisignserv
      - 2.3.9.2
      - two
      - all

  - name: Transfering digisigncliagree audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/digisigncliagree_2393_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisigncliagree
      - 2.3.9.3
      - two
      - all

  - name: Adding digisigncliagree in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DIGISIGNCLIAGREE = C:\facts\digisigncliagree_2393_audit.ps1'
      - '"digisigncliagree_2393_audit : $DIGISIGNCLIAGREE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - digisigncliagree
      - 2.3.9.3
      - two
      - all

  - name: Transfering disconclilogonhrexp audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/disconclilogonhrexp_2394_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - disconclilogonhrexp
      - 2.3.9.4
      - two
      - all

  - name: Adding disconclilogonhrexp in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISCONCLILOGONHREXP = C:\facts\disconclilogonhrexp_2394_audit.ps1'
      - '"disconclilogonhrexp_2394_audit : $DISCONCLILOGONHREXP"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - disconclilogonhrexp
      - 2.3.9.4
      - two
      - all

  - name: Transfering spnnamevalidation audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/spnnamevalidation_2395_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - spnnamevalidation
      - 2.3.9.5
      - two
      - all

  - name: Adding spnnamevalidation in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SPNNAMEVALIDATION = C:\facts\spnnamevalidation_2395_audit.ps1'
      - '"spnnamevalidation_2395_audit : $SPNNAMEVALIDATION"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - spnnamevalidation
      - 2.3.9.5
      - two
      - all
      
  - name: Transfering allowanonysid audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowanonysid_23101_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowanonysid
      - 2.3.10.1
      - two
      - all

  - name: Adding allowanonysid in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWANONYSID = C:\facts\allowanonysid_23101_audit.ps1'
      - '"allowanonysid_23101_audit : $ALLOWANONYSID"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowanonysid
      - 2.3.10.1
      - two
      - all

  - name: Transfering dontallowanonysamacc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowanonysamacc_23102_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - dontallowanonysamacc
      - 2.3.10.2
      - two
      - all

  - name: Adding dontallowanonysamacc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWANONYSAMACC = C:\facts\dontallowanonysamacc_23102_audit.ps1'
      - '"dontallowanonysamacc_23102_audit : $DONTALLOWANONYSAMACC"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - dontallowanonysamacc
      - 2.3.10.2
      - two
      - all

  - name: Transfering dontallowanonysamaccshares audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowanonysamaccshares_23103_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - dontallowanonysamaccshares
      - 2.3.10.3
      - two
      - all

  - name: Adding dontallowanonysamaccshares in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWANONYSAMACCSHARES = C:\facts\dontallowanonysamaccshares_23103_audit.ps1'
      - '"dontallowanonysamaccshares_23103_audit : $DONTALLOWANONYSAMACCSHARES"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - dontallowanonysamaccshares
      - 2.3.10.3
      - two
      - all

  - name: Transfering dontallowstoragepwdcred audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowstoragepwdcred_23104_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - dontallowstoragepwdcred
      - 2.3.10.4
      - two
      - all

  - name: Adding dontallowstoragepwdcred in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWSTORAGEPWDCRED = C:\facts\dontallowstoragepwdcred_23104_audit.ps1'
      - '"dontallowstoragepwdcred_23104_audit : $DONTALLOWSTORAGEPWDCRED"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - dontallowstoragepwdcred
      - 2.3.10.4
      - two
      - all

  - name: Transfering anonyusrperm audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/anonyusrperm_23105_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - anonyusrperm
      - 2.3.10.5
      - two
      - all

  - name: Adding anonyusrperm in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ANONYUSRPERM = C:\facts\anonyusrperm_23105_audit.ps1'
      - '"anonyusrperm_23105_audit : $ANONYUSRPERM"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - anonyusrperm
      - 2.3.10.5
      - two
      - all

  - name: Transfering namedpipesdc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/namedpipesdc_23106_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - namedpipesdc
      - 2.3.10.6
      - two
      - all

  - name: Adding namedpipesdc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$NAMEDPIPESDC = C:\facts\namedpipesdc_23106_audit.ps1'
      - '"namedpipesdc_23106_audit : $NAMEDPIPESDC"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - namedpipesdc
      - 2.3.10.6
      - two
      - all

  - name: Transfering namedpipesms audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/namedpipesms_23107_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - namedpipesms
      - 2.3.10.7
      - two
      - all

  - name: Adding namedpipesms in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$NAMEDPIPESMS = C:\facts\namedpipesms_23107_audit.ps1'
      - '"namedpipesms_23107_audit : $NAMEDPIPESMS"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - namedpipesms
      - 2.3.10.7
      - two
      - all

  - name: Transfering remoteaccesregpath audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/remoteaccesregpath_23108_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - remoteaccesregpath
      - 2.3.10.8
      - two
      - all

  - name: Adding remoteaccesregpath in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REMOTEACCESREGPATH = C:\facts\remoteaccesregpath_23108_audit.ps1'
      - '"remoteaccesregpath_23108_audit : $REMOTEACCESREGPATH"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - remoteaccesregpath
      - 2.3.10.8
      - two
      - all

  - name: Transfering remoteaccesregsubpath audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/remoteaccesregsubpath_23109_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - remoteaccesregsubpath
      - 2.3.10.9
      - two
      - all

  - name: Adding remoteaccesregsubpath in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REMOTEACCESREGSUBPATH = C:\facts\remoteaccesregsubpath_23109_audit.ps1'
      - '"remoteaccesregsubpath_23109_audit : $REMOTEACCESREGSUBPATH"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - remoteaccesregsubpath
      - 2.3.10.9
      - two
      - all

  - name: Transfering restrictanonyacces audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/restrictanonyacces_231010_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - restrictanonyacces
      - 2.3.10.10
      - two
      - all

  - name: Adding restrictanonyacces in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RESTRICTANONYACCES = C:\facts\restrictanonyacces_231010_audit.ps1'
      - '"restrictanonyacces_231010_audit : $RESTRICTANONYACCES"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'        
    tags:
      - restrictanonyacces
      - 2.3.10.10
      - two
      - all

  - name: Transfering sharesaccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/sharesaccess_231011_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - sharesaccess
      - 2.3.10.11
      - two
      - all

  - name: Adding sharesaccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SHARESACCESS = C:\facts\sharesaccess_231011_audit.ps1'
      - '"sharesaccess_231011_audit : $SHARESACCESS"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - sharesaccess
      - 2.3.10.11
      - two
      - all

  - name: Transfering sharesecurlocalacc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/sharesecurlocalacc_231012_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - sharesecurlocalacc
      - 2.3.10.12
      - two
      - all

  - name: Adding sharesecurlocalacc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SHARESECURLOCALACC = C:\facts\sharesecurlocalacc_231012_audit.ps1'
      - '"sharesecurlocalacc_231012_audit : $SHARESECURLOCALACC"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - sharesecurlocalacc
      - 2.3.10.12
      - two
      - all

  - name: Transfering allowlocalsys audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowlocalsys_23111_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowlocalsys
      - 2.3.11.1
      - two
      - all

  - name: Adding allowlocalsysnull in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWLOCALSYS = C:\facts\allowlocalsys_23111_audit.ps1'
      - '"allowlocalsys_23111_audit : $ALLOWLOCALSYS"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowlocalsys
      - 2.3.11.1
      - two
      - all
      
  - name: Transfering allowlocalsysnull audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowlocalsysnull_23112_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowlocalsysnull
      - 2.3.11.2
      - two
      - all

  - name: Adding allowlocalsysnull in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWLOCALSYSNULL = C:\facts\allowlocalsysnull_23112_audit.ps1'
      - '"allowlocalsysnull_23112_audit : $ALLOWLOCALSYSNULL"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowlocalsysnull
      - 2.3.11.2
      - two
      - all

  - name: Transfering allowpku2uauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowpku2uauthen_23113_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowpku2uauthen
      - 2.3.11.3
      - two
      - all

  - name: Adding allowpku2uauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWPKU2UAUTHEN = C:\facts\allowpku2uauthen_23113_audit.ps1'
      - '"allowpku2uauthen_23113_audit : $ALLOWPKU2UAUTHEN"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - allowpku2uauthen
      - 2.3.11.3
      - two
      - all
  
  - name: Transfering kerberosencryp audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/kerberosencryp_23114_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - kerberosencryp
      - 2.3.11.4
      - two
      - all

  - name: Adding kerberosencryp in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$KERBEROSENCRYP = C:\facts\kerberosencryp_23114_audit.ps1'
      - '"kerberosencryp_23114_audit : $KERBEROSENCRYP"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - kerberosencryp
      - 2.3.11.4
      - two
      - all
      
  - name: Transfering dontstorelanhashval audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontstorelanhashval_23115_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - dontstorelanhashval
      - 2.3.11.5
      - two
      - all

  - name: Adding dontstorelanhashval in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTSTORELANHASHVAL = C:\facts\dontstorelanhashval_23115_audit.ps1'
      - '"dontstorelanhashval_23115_audit : $DONTSTORELANHASHVAL"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - dontstorelanhashval
      - 2.3.11.5
      - two
      - all

  - name: Transfering forcelogoff audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/forcelogoff_23116_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - forcelogoff
      - 2.3.11.6
      - two
      - all

  - name: Adding forcelogoff in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$FORCELOGOFF = C:\facts\forcelogoff_23116_audit.ps1'
      - '"forcelogoff_23116_audit : $FORCELOGOFF"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - forcelogoff
      - 2.3.11.6
      - two
      - all

  - name: Transfering lanmgrauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/lanmgrauthen_23117_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - lanmgrauthen
      - 2.3.11.7
      - two
      - all

  - name: Adding lanmgrauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LANMGRAUTHEN = C:\facts\lanmgrauthen_23117_audit.ps1'
      - '"lanmgrauthen_23117_audit : $LANMGRAUTHEN"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - lanmgrauthen
      - 2.3.11.7
      - two
      - all

  - name: Transfering ldapclisign audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/ldapclisign_23118_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - ldapclisign
      - 2.3.11.8
      - two
      - all

  - name: Adding ldapclisign in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LDAPCLISIGN = C:\facts\ldapclisign_23118_audit.ps1'
      - '"ldapclisign_23118_audit : $LDAPCLISIGN"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - ldapclisign
      - 2.3.11.8
      - two
      - all

  - name: Transfering minsessionsecurcli audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/minsessionsecurcli_23119_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - minsessionsecurcli
      - 2.3.11.9
      - two
      - all

  - name: Adding minsessionsecurcli in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MINSESSIONSECURCLI = C:\facts\minsessionsecurcli_23119_audit.ps1'
      - '"minsessionsecurcli_23119_audit : $MINSESSIONSECURCLI"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - minsessionsecurcli
      - 2.3.11.9
      - two
      - all

  - name: Transfering minsessionsecurserv audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/minsessionsecurserv_231110_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - minsessionsecurserv
      - 2.3.11.10
      - two
      - all

  - name: Adding minsessionsecurserv in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MINSESSIONSECURSERV = C:\facts\minsessionsecurserv_231110_audit.ps1'
      - '"minsessionsecurserv_231110_audit : $MINSESSIONSECURSERV"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - minsessionsecurserv
      - 2.3.11.10
      - two
      - all

  - name: Transfering allowsysshutdown audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowsysshutdown_23131_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowsysshutdown
      - 2.3.13.1
      - two
      - all

  - name: Adding allowsysshutdown in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWSYSSHUTDOWN = C:\facts\allowsysshutdown_23131_audit.ps1'
      - '"allowsysshutdown_23131_audit : $ALLOWSYSSHUTDOWN"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - allowsysshutdown
      - 2.3.13.1
      - two
      - all

  - name: Transfering caseinsensnonwins audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/caseinsensnonwins_23151_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - caseinsensnonwins
      - 2.3.15.1
      - two
      - all

  - name: Adding caseinsensnonwins in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CASEINSENSNONWINS = C:\facts\caseinsensnonwins_23151_audit.ps1'
      - '"caseinsensnonwins_23151_audit : $CASEINSENSNONWINS"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - caseinsensnonwins
      - 2.3.15.1
      - two
      - all

  - name: Transfering strengthdefaultperm audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/strengthdefaultperm_23152_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - strengthdefaultperm
      - 2.3.15.2
      - two
      - all

  - name: Adding strengthdefaultperm in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$STRENGTHDEFAULTPERM = C:\facts\strengthdefaultperm_23152_audit.ps1'
      - '"strengthdefaultperm_23152_audit : $STRENGTHDEFAULTPERM"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - strengthdefaultperm
      - 2.3.15.2
      - two
      - all

  - name: Transfering setusraccctrl audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/setusraccctrl_23171_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - setusraccctrl
      - 2.3.17.1
      - two
      - all

  - name: Adding setusraccctrl in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SETUSRACCCTRL = C:\facts\setusraccctrl_23171_audit.ps1'
      - '"setusraccctrl_23171_audit : $SETUSRACCCTRL"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - setusraccctrl
      - 2.3.17.1
      - two
      - all

  - name: Transfering elevationpromptadmin audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/elevationpromptadmin_23172_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - elevationpromptadmin
      - 2.3.17.2
      - two
      - all

  - name: Adding elevationpromptadmin in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ELEVATIONPROMPTADMIN = C:\facts\elevationpromptadmin_23172_audit.ps1'
      - '"elevationpromptadmin_23172_audit : $ELEVATIONPROMPTADMIN"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - elevationpromptadmin
      - 2.3.17.2
      - two
      - all

  - name: Transfering elevationpromptusr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/elevationpromptusr_23173_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - elevationpromptusr
      - 2.3.17.3
      - two
      - all

  - name: Adding elevationpromptusr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ELEVATIONPROMPTUSR = C:\facts\elevationpromptusr_23173_audit.ps1'
      - '"elevationpromptusr_23173_audit : $ELEVATIONPROMPTUSR"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - elevationpromptusr
      - 2.3.17.3
      - two
      - all

  - name: Transfering detectappinstal audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/detectappinstal_23174_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - detectappinstal
      - 2.3.17.4
      - two
      - all

  - name: Adding detectappinstal in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DETECTAPPINSTAL = C:\facts\detectappinstal_23174_audit.ps1'
      - '"detectappinstal_23174_audit : $DETECTAPPINSTAL"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - detectappinstal
      - 2.3.17.4
      - two
      - all

  - name: Transfering elevateuiaccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/elevateuiaccess_23175_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - elevateuiaccess
      - 2.3.17.5
      - two
      - all

  - name: Adding elevateuiaccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ELEVATEUIACCESS = C:\facts\elevateuiaccess_23175_audit.ps1'
      - '"elevateuiaccess_23175_audit : $ELEVATEUIACCESS"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - elevateuiaccess
      - 2.3.17.5
      - two
      - all

  - name: Transfering runalladministrator audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/runalladministrator_23176_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - runalladministrator
      - 2.3.17.6
      - two
      - all

  - name: Adding runalladministrator in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RUNALLADMINISTRATOR = C:\facts\runalladministrator_23176_audit.ps1'
      - '"runalladministrator_23176_audit : $RUNALLADMINISTRATOR"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - runalladministrator
      - 2.3.17.6
      - two
      - all

  - name: Transfering switchsecuredesktop audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/switchsecuredesktop_23177_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - switchsecuredesktop
      - 2.3.17.7
      - two
      - all

  - name: Adding switchsecuredesktop in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SWITCHSECUREDESKTOP = C:\facts\switchsecuredesktop_23177_audit.ps1'
      - '"switchsecuredesktop_23177_audit : $SWITCHSECUREDESKTOP"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - switchsecuredesktop
      - 2.3.17.7
      - two
      - all

  - name: Transfering virtualizefileregistry audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/virtualizefileregistry_23178_audit.ps1
      dest: c:\facts\
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - virtualizefileregistry
      - 2.3.17.8
      - two
      - all

  - name: Adding virtualizefileregistry in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$VIRTUALIZEFILEREGISTRY = C:\facts\virtualizefileregistry_23178_audit.ps1'
      - '"virtualizefileregistry_23178_audit : $VIRTUALIZEFILEREGISTRY"'
    when:  
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'    
    tags:
      - virtualizefileregistry
      - 2.3.17.8
      - two
      - all

  - name: Transfering domainfirewallstate audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/domainfirewallstate_911_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - domainfirewallstate
      - 9.1.1
      - nine
      - all

  - name: Adding domainfirewallstate in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DOMAINFIREWALLSTATE = C:\facts\domainfirewallstate_911_audit.ps1'
      - '"domainfirewallstate_911_audit : $DOMAINFIREWALLSTATE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - domainfirewallstate
      - 9.1.1
      - nine
      - all

  - name: Transfering inboundconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/inboundconn_912_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - inboundconn
      - 9.1.2
      - nine
      - all

  - name: Adding inboundconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$INBOUNDCONN = C:\facts\inboundconn_912_audit.ps1'
      - '"inboundconn_912_audit : $INBOUNDCONN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - inboundconn
      - 9.1.2
      - nine
      - all

  - name: Transfering outboundconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/outboundconn_913_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - outboundconn
      - 9.1.3
      - nine
      - all

  - name: Adding in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$OUTBOUNDCONN = C:\facts\outboundconn_913_audit.ps1'
      - '"outboundconn_913_audit : $OUTBOUNDCONN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - outboundconn
      - 9.1.3
      - nine
      - all

  - name: Transfering disablenotificdisplay audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/disablenotificdisplay_914_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - disablenotificdisplay
      - 9.1.4
      - nine
      - all

  - name: Adding disablenotificdisplay in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISABLENOTIFICDISPLAY = C:\facts\disablenotificdisplay_914_audit.ps1'
      - '"disablenotificdisplay_914_audit : $DISABLENOTIFICDISPLAY"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - disablenotificdisplay
      - 9.1.4
      - nine
      - all

  - name: Transfering loggingname audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/loggingname_915_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - loggingname
      - 9.1.5
      - nine
      - all

  - name: Adding loggingname in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOGGINGNAME = C:\facts\loggingname_915_audit.ps1'
      - '"loggingname_915_audit : $LOGGINGNAME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - loggingname
      - 9.1.5
      - nine
      - all

  - name: Transfering loggingsizelimit audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/loggingsizelimit_916_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - loggingsizelimit
      - 9.1.6
      - nine
      - all

  - name: Adding loggingsizelimit in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOGGINGSIZELIMIT = C:\facts\loggingsizelimit_916_audit.ps1'
      - '"loggingsizelimit_916_audit : $LOGGINGSIZELIMIT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - loggingsizelimit
      - 9.1.6
      - nine
      - all

  - name: Transfering logginglogdroppack audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/logginglogdroppack_917_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - logginglogdroppack
      - 9.1.7
      - nine
      - all

  - name: Adding logginglogdroppack in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOGGINGLOGDROPPACK = C:\facts\logginglogdroppack_917_audit.ps1'
      - '"logginglogdroppack_917_audit : $LOGGINGLOGDROPPACK"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - logginglogdroppack
      - 9.1.7
      - nine
      - all

  - name: Transfering logginglogsuccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/logginglogsuccess_918_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - logginglogsuccess
      - 9.1.8
      - nine
      - all

  - name: Adding logginglogsuccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOGGINGLOGSUCCESS = C:\facts\logginglogsuccess_918_audit.ps1'
      - '"logginglogsuccess_918_audit : $LOGGINGLOGSUCCESS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - logginglogsuccess
      - 9.1.8
      - nine
      - all

  - name: Transfering pvtfirewallstate audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtfirewallstate_921_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtfirewallstate
      - 9.2.1
      - nine
      - all

  - name: Adding pvtfirewallstate in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTFIREWALLSTATE = C:\facts\pvtfirewallstate_921_audit.ps1'
      - '"pvtfirewallstate_921_audit : $PVTFIREWALLSTATE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtfirewallstate
      - 9.2.1
      - nine
      - all

  - name: Transfering pvtinboundconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtinboundconn_922_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtinboundconn
      - 9.2.2
      - nine
      - all

  - name: Adding pvtinboundconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTINBOUNDCONN = C:\facts\pvtinboundconn_922_audit.ps1'
      - '"pvtinboundconn_922_audit : $PVTINBOUNDCONN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtinboundconn
      - 9.2.2
      - nine
      - all

  - name: Transfering pvtoutboundconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtoutboundconn_923_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtoutboundconn
      - 9.2.3
      - nine
      - all

  - name: Adding  pvtoutboundconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTOUTBOUNDCONN = C:\facts\pvtoutboundconn_923_audit.ps1'
      - '"pvtoutboundconn_923_audit : $PVTOUTBOUNDCONN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtoutboundconn
      - 9.2.3
      - nine
      - all

  - name: Transfering pvtdisablenotification audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtdisablenotification_924_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtdisablenotification
      - 9.2.4
      - nine
      - all

  - name: Adding pvtdisablenotification in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTDISABLENOTIFICATION = C:\facts\pvtdisablenotification_924_audit.ps1'
      - '"pvtdisablenotification_924_audit : $PVTDISABLENOTIFICATION"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtdisablenotification
      - 9.2.4
      - nine
      - all

  - name: Transfering pvtloggingname audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtloggingname_925_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtloggingname
      - 9.2.5
      - nine
      - all

  - name: Adding pvtloggingname in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTLOGGINGNAME = C:\facts\pvtloggingname_925_audit.ps1'
      - '"pvtloggingname_925_audit : $PVTLOGGINGNAME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtloggingname
      - 9.2.5
      - nine
      - all

  - name: Transfering pvtloggingsizelimit audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtloggingsizelimit_926_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtloggingsizelimit
      - 9.2.6
      - nine
      - all

  - name: Adding pvtloggingsizelimit in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTLOGGINGSIZELIMIT = C:\facts\pvtloggingsizelimit_926_audit.ps1'
      - '"pvtloggingsizelimit_926_audit : $PVTLOGGINGSIZELIMIT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtloggingsizelimit
      - 9.2.6
      - nine
      - all

  - name: Transfering pvtlogginglogdroppack audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtlogginglogdroppack_927_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtlogginglogdroppack
      - 9.2.7
      - nine
      - all

  - name: Adding pvtlogginglogdroppack in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTLOGGINGLOGDROPPACK = C:\facts\pvtlogginglogdroppack_927_audit.ps1'
      - '"pvtlogginglogdroppack_927_audit : $PVTLOGGINGLOGDROPPACK"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtlogginglogdroppack
      - 9.2.7
      - nine
      - all

  - name: Transfering pvtlogginglogsuccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pvtlogginglogsuccess_928_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtlogginglogsuccess
      - 9.2.8
      - nine
      - all

  - name: Adding pvtlogginglogsuccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PVTLOGGINGLOGSUCCESS = C:\facts\pvtlogginglogsuccess_928_audit.ps1'
      - '"pvtlogginglogsuccess_928_audit : $PVTLOGGINGLOGSUCCESS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pvtlogginglogsuccess
      - 9.2.8
      - nine
      - all

  - name: Transfering pubfirewallstate audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pubfirewallstate_931_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pubfirewallstate
      - 9.3.1
      - nine
      - all

  - name: Adding pubfirewallstate in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBFIREWALLSTATE = C:\facts\pubfirewallstate_931_audit.ps1'
      - '"pubfirewallstate_931_audit : $PUBFIREWALLSTATE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pubfirewallstate
      - 9.3.1
      - nine
      - all

  - name: Transfering pubinboundconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pubinboundconn_932_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pubinboundconn
      - 9.3.2
      - nine
      - all

  - name: Adding pubinboundconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBINBOUNDCONN = C:\facts\pubinboundconn_932_audit.ps1'
      - '"pubinboundconn_932_audit : $PUBINBOUNDCONN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pubinboundconn
      - 9.3.2
      - nine
      - all

  - name: Transfering puboutboundconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/puboutboundconn_933_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - puboutboundconn
      - 9.3.3
      - nine
      - all

  - name: Adding puboutboundconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBOUTBOUNDCONN = C:\facts\puboutboundconn_933_audit.ps1'
      - '"puboutboundconn_933_audit : $PUBOUTBOUNDCONN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - puboutboundconn
      - 9.3.3
      - nine
      - all

  - name: Transfering pubdisablenotification audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pubdisablenotification_934_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pubdisablenotification
      - 9.3.4
      - nine
      - all

  - name: Adding pubdisablenotification in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBDISABLENOTIFICATION = C:\facts\pubdisablenotification_934_audit.ps1'
      - '"pubdisablenotification_934_audit : $PUBDISABLENOTIFICATION"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - pubdisablenotification
      - 9.3.4
      - nine
      - all

  - name: Transfering localfirewallrules audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/localfirewallrules_935_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - localfirewallrules
      - 9.3.5
      - nine
      - all

  - name: Adding localfirewallrules in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOCALFIREWALLRULES = C:\facts\localfirewallrules_935_audit.ps1'
      - '"localfirewallrules_935_audit : $LOCALFIREWALLRULES"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - localfirewallrules
      - 9.3.5
      - nine
      - all

  - name: Transfering localconnsecurules audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/localconnsecurules_936_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - localconnsecurules
      - 9.3.6
      - nine
      - all

  - name: Adding localconnsecurules in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOCALCONNSECURULES = C:\facts\localconnsecurules_936_audit.ps1'
      - '"localconnsecurules_936_audit : $LOCALCONNSECURULES"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - localconnsecurules
      - 9.3.6
      - nine
      - all

  - name: Transfering publoggingname audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/publoggingname_937_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publoggingname
      - 9.3.7
      - nine
      - all

  - name: Adding publoggingname in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBLOGGINGNAME = C:\facts\publoggingname_937_audit.ps1'
      - '"publoggingname_937_audit : $PUBLOGGINGNAME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publoggingname
      - 9.3.7
      - nine
      - all

  - name: Transfering publoggingsizelimit audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/publoggingsizelimit_938_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publoggingsizelimit
      - 9.3.8
      - nine
      - all

  - name: Adding publoggingsizelimit in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBLOGGINGSIZELIMIT = C:\facts\publoggingsizelimit_938_audit.ps1'
      - '"publoggingsizelimit_938_audit : $PUBLOGGINGSIZELIMIT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publoggingsizelimit
      - 9.3.8
      - nine
      - all

  - name: Transfering publogginglogdroppack audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/publogginglogdroppack_939_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publogginglogdroppack
      - 9.3.9
      - nine
      - all

  - name: Adding publogginglogdroppack in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBLOGGINGLOGDROPPACK = C:\facts\publogginglogdroppack_939_audit.ps1'
      - '"publogginglogdroppack_939_audit : $PUBLOGGINGLOGDROPPACK"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publogginglogdroppack
      - 9.3.9
      - nine
      - all

  - name: Transfering publogginglogsuccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/publogginglogsuccess_9310_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publogginglogsuccess
      - 9.3.10
      - nine
      - all

  - name: Adding publogginglogsuccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PUBLOGGINGLOGSUCCESS = C:\facts\publogginglogsuccess_9310_audit.ps1'
      - '"publogginglogsuccess_9310_audit : $PUBLOGGINGLOGSUCCESS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'   
    tags:
      - publogginglogsuccess
      - 9.3.10
      - nine
      - all

  - name: Transfering audcredvalidation audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audcredvalidation_1711_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audcredvalidation
      - 17.1.1
      - seventeen
      - all

  - name: Adding audcredvalidation in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDCREDVALIDATION = C:\facts\audcredvalidation_1711_audit.ps1'
      - '"audcredvalidation_1711_audit : $AUDCREDVALIDATION"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audcredvalidation
      - 17.1.1
      - seventeen
      - all

  - name: Transfering audkerberosauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audkerberosauthen_1712_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audkerberosauthen
      - 17.1.2
      - seventeen
      - all

  - name: Adding audkerberosauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDKERBEROSAUTHEN = C:\facts\audkerberosauthen_1712_audit.ps1'
      - '"audkerberosauthen_1712_audit : $AUDKERBEROSAUTHEN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audkerberosauthen
      - 17.1.2
      - seventeen
      - all

  - name: Transfering audkerberossrvtick audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audkerberossrvtick_1713_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audkerberossrvtick
      - 17.1.3
      - seventeen
      - all

  - name: Adding audkerberossrvtick in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDKERBEROSSRVTICK = C:\facts\audkerberossrvtick_1713_audit.ps1'
      - '"audkerberossrvtick_1713_audit : $AUDKERBEROSSRVTICK"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audkerberossrvtick
      - 17.1.3
      - seventeen
      - all

  - name: Transfering audappgrpmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audappgrpmangment_1721_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audappgrpmangment
      - 17.2.1
      - seventeen
      - all

  - name: Adding audappgrpmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDAPPGRPMANGMENT = C:\facts\audappgrpmangment_1721_audit.ps1'
      - '"audappgrpmangment_1721_audit : $AUDAPPGRPMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audappgrpmangment
      - 17.2.1
      - seventeen
      - all

  - name: Transfering audcompaccmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audcompaccmangment_1722_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audcompaccmangment
      - 17.2.2
      - seventeen
      - all

  - name: Adding audcompaccmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDCOMPACCMANGMENT = C:\facts\audcompaccmangment_1722_audit.ps1'
      - '"audcompaccmangment_1722_audit : $AUDCOMPACCMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audcompaccmangment
      - 17.2.2
      - seventeen
      - all

  - name: Transfering auddistribgrpmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auddistribgrpmangment_1723_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - auddistribgrpmangment
      - 17.2.3
      - seventeen
      - all

  - name: Adding auddistribgrpmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDDISTRIBGRPMANGMENT = C:\facts\auddistribgrpmangment_1723_audit.ps1'
      - '"auddistribgrpmangment_1723_audit : $AUDDISTRIBGRPMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - auddistribgrpmangment
      - 17.2.3
      - seventeen
      - all

  - name: Transfering audotheraccmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audotheraccmangment_1724_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audotheraccmangment
      - 17.2.4
      - seventeen
      - all

  - name: Adding audotheraccmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDOTHERACCMANGMENT = C:\facts\audotheraccmangment_1724_audit.ps1'
      - '"audotheraccmangment_1724_audit : $AUDOTHERACCMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - audotheraccmangment
      - 17.2.4
      - seventeen
      - all

  - name: Transfering audsecurgrpmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audsecurgrpmangment_1725_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audsecurgrpmangment
      - 17.2.5
      - seventeen
      - all

  - name: Adding audsecurgrpmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDSECURGRPMANGMENT = C:\facts\audsecurgrpmangment_1725_audit.ps1'
      - '"audsecurgrpmangment_1725_audit : $AUDSECURGRPMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audsecurgrpmangment
      - 17.2.5
      - seventeen
      - all

  - name: Transfering audusraccmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audusraccmangment_1726_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audusraccmangment
      - 17.2.6
      - seventeen
      - all

  - name: Adding audusraccmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDUSRACCMANGMENT = C:\facts\audusraccmangment_1726_audit.ps1'
      - '"audusraccmangment_1726_audit : $AUDUSRACCMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'          
    tags:
      - audusraccmangment
      - 17.2.6
      - seventeen
      - all

  - name: Transfering auditprocesscreation audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditprocesscreation_1731_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'            
    tags:
      - 17.3.1
      - seventeen
      - all

  - name: Adding auditprocesscreation in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITPROCESSCREATION = C:\facts\auditprocesscreation_1731_audit.ps1'
      - '"auditprocesscreation_1731_audit : $AUDITPROCESSCREATION"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'            
    tags:
      - 17.3.1
      - seventeen
      - all

  - name: Transfering auditdirservaccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditdirservaccess_1741_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - 17.4.1
      - seventeen
      - all

  - name: Adding auditdirservaccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITDIRSERVACCESS = C:\facts\auditdirservaccess_1741_audit.ps1'
      - '"auditdirservaccess_1741_audit : $AUDITDIRSERVACCESS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - 17.4.1
      - seventeen
      - all

  - name: Transfering auditdirservchg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditdirservchg_1742_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - 17.4.2
      - seventeen
      - all

  - name: Adding auditdirservchg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITDIRSERVCHG = C:\facts\auditdirservchg_1742_audit.ps1'
      - '"auditdirservchg_1742_audit : $AUDITDIRSERVCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - 17.4.2
      - seventeen
      - all

  - name: Transfering auditacclockout audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditacclockout_1751_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.1
      - seventeen
      - all

  - name: Adding auditacclockout in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITACCLOCKOUT = C:\facts\auditacclockout_1751_audit.ps1'
      - '"auditacclockout_1751_audit : $AUDITACCLOCKOUT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.1
      - seventeen
      - all

  - name: Transfering auditlogoff audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditlogoff_1752_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.2
      - seventeen
      - all

  - name: Adding auditlogoff in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITLOGOFF = C:\facts\auditlogoff_1752_audit.ps1'
      - '"auditlogoff_1752_audit : $AUDITLOGOFF"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.2
      - seventeen
      - all

  - name: Transfering auditlogon audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditlogon_1753_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.3
      - seventeen
      - all

  - name: Adding auditlogon in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITLOGON = C:\facts\auditlogon_1753_audit.ps1'
      - '"auditlogon_1753_audit : $AUDITLOGON"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.3
      - seventeen
      - all

  - name: Transfering auditotherlogonoff audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditotherlogonoff_1754_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.4
      - seventeen
      - all

  - name: Adding auditotherlogonoff in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITOTHERLOGONOFF = C:\facts\auditotherlogonoff_1754_audit.ps1'
      - '"auditotherlogonoff_1754_audit : $AUDITOTHERLOGONOFF"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.4
      - seventeen
      - all

  - name: Transfering auditspeciallogon audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditspeciallogon_1755_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.5
      - seventeen
      - all

  - name: Adding auditspeciallogon in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITSPECIALLOGON = C:\facts\auditspeciallogon_1755_audit.ps1'
      - '"auditspeciallogon_1755_audit : $AUDITSPECIALLOGON"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.5.5
      - seventeen
      - all

  - name: Transfering auddtailedfileshre audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auddtailedfileshre_1761_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - auddtailedfileshre
      - 17.6.1
      - seventeen
      - all

  - name: Adding auddtailedfileshre in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDDTAILEDFILESHRE = C:\facts\auddtailedfileshre_1761_audit.ps1'
      - '"auddtailedfileshre_1761_audit : $AUDDTAILEDFILESHRE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - auddtailedfileshre
      - 17.6.1
      - seventeen
      - all

  - name: Transfering audfileshare audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audfileshare_1762_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - audfileshare
      - 17.6.2
      - seventeen
      - all

  - name: Adding audfileshare in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDFILESHARE = C:\facts\audfileshare_1762_audit.ps1'
      - '"audfileshare_1762_audit : $AUDFILESHARE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - audfileshare
      - 17.6.2
      - seventeen
      - all

  - name: Transfering auditotherobjaccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditotherobjaccess_1763_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.6.3
      - seventeen
      - all

  - name: Adding auditotherobjaccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITOTHEROBJACCESS = C:\facts\auditotherobjaccess_1763_audit.ps1'
      - '"auditotherobjaccess_1763_audit : $AUDITOTHEROBJACCESS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.6.3
      - seventeen
      - all

  - name: Transfering auditremovablestorage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditremovablestorage_1764_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.6.4
      - seventeen
      - all

  - name: Adding auditremovablestorage in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITREMOVABLESTORAGE = C:\facts\auditremovablestorage_1764_audit.ps1'
      - '"auditremovablestorage_1764_audit : $AUDITREMOVABLESTORAGE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.6.4
      - seventeen
      - all
      
  - name: Transfering auditpolicychg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditpolicychg_1771_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.7.1
      - seventeen
      - all

  - name: Adding auditpolicychg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITPOLICYCHG = C:\facts\auditpolicychg_1771_audit.ps1'
      - '"auditpolicychg_1771_audit : $AUDITPOLICYCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.7.1
      - seventeen
      - all

  - name: Transfering auditauthenpolicychg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditauthenpolicychg_1772_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.7.2
      - seventeen
      - all

  - name: Adding auditauthenpolicychg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITAUTHENPOLICYCHG = C:\facts\auditauthenpolicychg_1772_audit.ps1'
      - '"auditauthenpolicychg_1772_audit : $AUDITAUTHENPOLICYCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.7.2
      - seventeen
      - all

  - name: Transfering auditauthornpolicychg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditauthornpolicychg_1773_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.7.3
      - seventeen
      - all

  - name: Adding auditauthornpolicychg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITAUTHORNPOLICYCHG = C:\facts\auditauthornpolicychg_1773_audit.ps1'
      - '"auditauthornpolicychg_1773_audit : $AUDITAUTHORNPOLICYCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.7.3
      - seventeen
      - all

  - name: Transfering audmpssvcrulelevelpolicychg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audmpssvcrulelevelpolicychg_1774_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - audmpssvcrulelevelpolicychg
      - 17.7.4
      - seventeen
      - all

  - name: Adding audmpssvcrulelevelpolicychg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDMPSSVCRULELEVELPOLICYCHG = C:\facts\audmpssvcrulelevelpolicychg_1774_audit.ps1'
      - '"audmpssvcrulelevelpolicychg_1774_audit : $AUDMPSSVCRULELEVELPOLICYCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - audmpssvcrulelevelpolicychg
      - 17.7.4
      - seventeen
      - all

  - name: Transfering audothrpolicychg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/audothrpolicychg_1775_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - audothrpolicychg
      - 17.7.5
      - seventeen
      - all

  - name: Adding audothrpolicychg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDOTHRPOLICYCHG = C:\facts\audothrpolicychg_1775_audit.ps1'
      - '"audothrpolicychg_1775_audit : $AUDOTHRPOLICYCHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - audothrpolicychg
      - 17.7.5
      - seventeen
      - all

  - name: Transfering auditsensitiveprivuse audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditsensitiveprivuse_1781_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.8.1
      - seventeen
      - all

  - name: Adding auditsensitiveprivuse in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITSENSITIVEPRIVUSE = C:\facts\auditsensitiveprivuse_1781_audit.ps1'
      - '"auditsensitiveprivuse_1781_audit : $AUDITSENSITIVEPRIVUSE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.8.1
      - seventeen
      - all

  - name: Transfering auditipsecdriver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditipsecdriver_1791_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.1
      - seventeen
      - all

  - name: Adding auditipsecdriver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITIPSECDRIVER = C:\facts\auditipsecdriver_1791_audit.ps1'
      - '"auditipsecdriver_1791_audit : $AUDITIPSECDRIVER"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.1
      - seventeen
      - all

  - name: Transfering auditothersysevents audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditothersysevents_1792_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.2
      - seventeen
      - all

  - name: Adding auditothersysevents in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITOTHERSYSEVENTS = C:\facts\auditothersysevents_1792_audit.ps1'
      - '"auditothersysevents_1792_audit : $AUDITOTHERSYSEVENTS"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.2
      - seventeen
      - all

  - name: Transfering auditsecurstatechg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditsecurstatechg_1793_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.3
      - seventeen
      - all

  - name: Adding auditsecurstatechg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITSECURSTATECHG = C:\facts\auditsecurstatechg_1793_audit.ps1'
      - '"auditsecurstatechg_1793_audit : $AUDITSECURSTATECHG"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.3
      - seventeen
      - all

  - name: Transfering auditsecursysext audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditsecursysext_1794_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.4
      - seventeen
      - all

  - name: Adding auditsecursysext in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITSECURSYSEXT = C:\facts\auditsecursysext_1794_audit.ps1'
      - '"auditsecursysext_1794_audit : $AUDITSECURSYSEXT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.4
      - seventeen
      - all

  - name: Transfering auditsysintegrity audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/auditsysintegrity_1795_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.5
      - seventeen
      - all

  - name: Adding auditsysintegrity in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUDITSYSINTEGRITY = C:\facts\auditsysintegrity_1795_audit.ps1'
      - '"auditsysintegrity_1795_audit : $AUDITSYSINTEGRITY"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - 17.9.5
      - seventeen
      - all

      
  - name: Transfering lapsadmpwd audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/lapsadmpwd_1821_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - lapsadmpwd
      - 18.2.1
      - eighteen
      - all

  - name: Adding lapsadmpwd in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LAPSADMPWD = C:\facts\lapsadmpwd_1821_audit.ps1'
      - '"lapsadmpwd_1821_audit : $LAPSADMPWD"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - lapsadmpwd
      - eighteen
      - 18.2.1
      - all

  - name: Transfering dontallowpwdexpirtime audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowpwdexpirtime_1822_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - dontallowpwdexpirtime
      - eighteen
      - 18.2.2
      - all

  - name: Adding dontallowpwdexpirtime in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWPWDEXPIRTIME = C:\facts\dontallowpwdexpirtime_1822_audit.ps1'
      - '"dontallowpwdexpirtime_1822_audit : $DONTALLOWPWDEXPIRTIME"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - dontallowpwdexpirtime
      - eighteen
      - 18.2.2
      - all

  - name: Transfering localadmpwdmangment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/localadmpwdmangment_1823_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - localadmpwdmangment
      - eighteen
      - 18.2.3
      - all

  - name: Adding localadmpwdmangment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$LOCALADMPWDMANGMENT = C:\facts\localadmpwdmangment_1823_audit.ps1'
      - '"localadmpwdmangment_1823_audit : $LOCALADMPWDMANGMENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - localadmpwdmangment
      - eighteen
      - 18.2.3
      - all

  - name: Transfering pwdcomplexity audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdcomplexity_1824_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - pwdcomplexity
      - eighteen
      - 18.2.4
      - all

  - name: Adding pwdcomplexity in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDCOMPLEXITY = C:\facts\pwdcomplexity_1824_audit.ps1'
      - '"pwdcomplexity_1824_audit : $PWDCOMPLEXITY"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - pwdcomplexity
      - eighteen
      - 18.2.4
      - all

  - name: Transfering pwdlength audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdlength_1825_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - pwdlength
      - eighteen
      - 18.2.5
      - all

  - name: Adding pwdlength in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDLENGTH = C:\facts\pwdlength_1825_audit.ps1'
      - '"pwdlength_1825_audit : $PWDLENGTH"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - pwdlength
      - eighteen
      - 18.2.5
      - all

  - name: Transfering pwdage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdage_1826_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - pwdage
      - eighteen
      - 18.2.6
      - all

  - name: Adding pwdage in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDAGE = C:\facts\pwdage_1826_audit.ps1'
      - '"pwdage_1826_audit : $PWDAGE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - pwdage
      - eighteen
      - 18.2.6
      - all

  - name: Transfering uacrestrictlocalacc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/uacrestrictlocalacc_1831_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - uacrestrictlocalacc
      - eighteen
      - 18.3.1
      - all

  - name: Adding uacrestrictlocalacc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$UACRESTRICTLOCALACC = C:\facts\uacrestrictlocalacc_1831_audit.ps1'
      - '"uacrestrictlocalacc_1831_audit : $UACRESTRICTLOCALACC"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - uacrestrictlocalacc
      - eighteen
      - 18.3.1
      - all

  - name: Transfering confsmbenable audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confsmbenable_1832_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - confsmbenable
      - eighteen
      - 18.3.2
      - all

  - name: Adding confsmbenable in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFSMBENABLE = C:\facts\confsmbenable_1832_audit.ps1'
      - '"confsmbenable_1832_audit : $CONFSMBENABLE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - confsmbenable
      - eighteen
      - 18.3.2
      - all


  - name: Transfering confsmbclient audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confsmbclient_1833_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - confsmbclient
      - eighteen
      - 18.3.3
      - all

  - name: Adding confsmbclient in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFSMBCLIENT = C:\facts\confsmbclient_1833_audit.ps1'
      - '"confsmbclient_1833_audit : $CONFSMBCLIENT"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - confsmbclient
      - eighteen
      - 18.3.3
      - all

  - name: Transfering confsmbserver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confsmbserver_1834_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - confsmbserver
      - eighteen
      - 18.3.4
      - all

  - name: Adding confsmbserver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFSMBSERVER = C:\facts\confsmbserver_1834_audit.ps1'
      - '"confsmbserver_1834_audit : $CONFSMBSERVER"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - confsmbserver
      - eighteen
      - 18.3.4
      - all

  - name: Transfering enablesehop audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enablesehop_1835_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - enablesehop
      - eighteen
      - 18.3.5
      - all

  - name: Adding enablesehop in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENABLESEHOP = C:\facts\enablesehop_1835_audit.ps1'
      - '"enablesehop_1835_audit : $ENABLESEHOP"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - enablesehop
      - eighteen
      - 18.3.5
      - all

  - name: Transfering enableexprotldap audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enableexprotldap_1836_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - enableexprotldap
      - eighteen
      - 18.3.6
      - all

  - name: Adding enableexprotldap in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENABLEEXPROTLDAP = C:\facts\enableexprotldap_1836_audit.ps1'
      - '"enableexprotldap_1836_audit : $ENABLEEXPROTLDAP"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
    tags:
      - enableexprotldap
      - eighteen
      - 18.3.6
      - all

  - name: Transfering netbiosnodetype audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/netbiosnodetype_1837_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - netbiosnodetype
      - eighteen
      - 18.3.7
      - all

  - name: Adding netbiosnodetype in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$NETBIOSNODETYPE = C:\facts\netbiosnodetype_1837_audit.ps1'
      - '"netbiosnodetype_1837_audit : $NETBIOSNODETYPE"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - netbiosnodetype
      - eighteen
      - 18.3.7
      - all

  - name: Transfering wdigestauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/wdigestauthen_1838_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - wdigestauthen
      - eighteen
      - 18.3.8
      - all

  - name: Adding wdigestauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$WDIGESTAUTHEN = C:\facts\wdigestauthen_1838_audit.ps1'
      - '"wdigestauthen_1838_audit : $WDIGESTAUTHEN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5' or (server_type.stdout_lines[1] | regex_search('3')) == '3' or (server_type.stdout_lines[1] | regex_search('2')) == '2'  
    tags:
      - wdigestauthen
      - eighteen
      - 18.3.8
      - all
      
  - name: Transfering autologon audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/autologon_1841_audit.ps1
      dest: c:\facts\
    tags:
      - autologon
      - eighteen
      - 18.4.1
      - all

  - name: Adding autologon in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUTOLOGON = C:\facts\autologon_1841_audit.ps1'
      - '"autologon_1841_audit : $AUTOLOGON"'
    tags:
      - autologon
      - eighteen
      - 18.4.1
      - all

  - name: Transfering ipsourcerouting audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/ipsourcerouting_1842_audit.ps1
      dest: c:\facts\
    tags:
      - ipsourcerouting
      - eighteen
      - 18.4.2
      - all

  - name: Adding ipsourcerouting in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$IPSOURCEROUTING = C:\facts\ipsourcerouting_1842_audit.ps1'
      - '"ipsourcerouting_1842_audit : $IPSOURCEROUTING"'
    tags:
      - ipsourcerouting
      - eighteen
      - 18.4.2
      - all

  - name: Transfering ipsourceroutprotect audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/ipsourceroutprotect_1843_audit.ps1
      dest: c:\facts\
    tags:
      - ipsourceroutprotect
      - eighteen
      - 18.4.3
      - all

  - name: Adding ipsourceroutprotect in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$IPSOURCEROUTPROTECT = C:\facts\ipsourceroutprotect_1843_audit.ps1'
      - '"ipsourceroutprotect_1843_audit : $IPSOURCEROUTPROTECT"'
    tags:
      - ipsourceroutprotect
      - eighteen
      - 18.4.3
      - all

  - name: Transfering icmpredirects audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/icmpredirects_1844_audit.ps1
      dest: c:\facts\
    tags:
      - icmpredirects
      - eighteen
      - 18.4.4
      - all

  - name: Adding icmpredirects in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ICMPREDIRECTS = C:\facts\icmpredirects_1844_audit.ps1'
      - '"icmpredirects_1844_audit : $ICMPREDIRECTS"'
    tags:
      - icmpredirects
      - eighteen
      - 18.4.4
      - all

  - name: Transfering keepalivetime audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/keepalivetime_1845_audit.ps1
      dest: c:\facts\
    tags:
      - keepalivetime
      - eighteen
      - 18.4.5
      - all

  - name: Adding keepalivetime in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$KEEPALIVETIME = C:\facts\keepalivetime_1845_audit.ps1'
      - '"keepalivetime_1845_audit : $KEEPALIVETIME"'
    tags:
      - keepalivetime
      - eighteen
      - 18.4.5
      - all

  - name: Transfering nonamerelease audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/nonamerelease_1846_audit.ps1
      dest: c:\facts\
    tags:
      - nonamerelease
      - eighteen
      - 18.4.6
      - all

  - name: Adding nonamerelease in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$NONAMERELEASE = C:\facts\nonamerelease_1846_audit.ps1'
      - '"nonamerelease_1846_audit : $NONAMERELEASE"'
    tags:
      - nonamerelease
      - eighteen
      - 18.4.6
      - all

  - name: Transfering perfroutdiscovery audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/perfroutdiscovery_1847_audit.ps1
      dest: c:\facts\
    tags:
      - perfroutdiscovery
      - eighteen
      - 18.4.7
      - all

  - name: Adding perfroutdiscovery in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PERFROUTDISCOVERY = C:\facts\perfroutdiscovery_1847_audit.ps1'
      - '"perfroutdiscovery_1847_audit : $PERFROUTDISCOVERY"'
    tags:
      - perfroutdiscovery
      - eighteen
      - 18.4.7
      - all

  - name: Transfering safedllsearchmode audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/safedllsearchmode_1848_audit.ps1
      dest: c:\facts\
    tags:
      - safedllsearchmode
      - eighteen
      - 18.4.8
      - all

  - name: Adding safedllsearchmode in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SAFEDLLSEARCHMODE = C:\facts\safedllsearchmode_1848_audit.ps1'
      - '"safedllsearchmode_1848_audit : $SAFEDLLSEARCHMODE"'
    tags:
      - safedllsearchmode
      - eighteen
      - 18.4.8
      - all

  - name: Transfering screensavertime audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/screensavertime_1849_audit.ps1
      dest: c:\facts\
    tags:
      - screensavertime
      - eighteen
      - 18.4.9
      - all

  - name: Adding screensavertime in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SCREENSAVERTIME = C:\facts\screensavertime_1849_audit.ps1'
      - '"screensavertime_1849_audit : $SCREENSAVERTIME"'
    tags:
      - screensavertime
      - eighteen
      - 18.4.9
      - all

  - name: Transfering tcpmaxdataretransipv6 audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/tcpmaxdataretransipv6_18410_audit.ps1
      dest: c:\facts\
    tags:
      - tcpmaxdataretransipv6
      - eighteen
      - 18.4.10
      - all

  - name: Adding tcpmaxdataretransipv6 in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TCPMAXDATARETRANSIPV6 = C:\facts\tcpmaxdataretransipv6_18410_audit.ps1'
      - '"tcpmaxdataretransipv6_18410_audit : $TCPMAXDATARETRANSIPV6"'
    tags:
      - tcpmaxdataretransipv6
      - eighteen
      - 18.4.10
      - all

  - name: Transfering tcpmaxdataretrans audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/tcpmaxdataretrans_18411_audit.ps1
      dest: c:\facts\
    tags:
      - tcpmaxdataretrans
      - eighteen
      - 18.4.11
      - all

  - name: Adding tcpmaxdataretrans in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TCPMAXDATARETRANS = C:\facts\tcpmaxdataretrans_18411_audit.ps1'
      - '"tcpmaxdataretrans_18411_audit : $TCPMAXDATARETRANS"'
    tags:
      - tcpmaxdataretrans
      - eighteen
      - 18.4.11
      - all

  - name: Transfering warninglevel audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/warninglevel_18412_audit.ps1
      dest: c:\facts\
    tags:
      - warninglevel
      - eighteen
      - 18.4.12
      - all

  - name: Adding warninglevel in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$WARNINGLEVEL = C:\facts\warninglevel_18412_audit.ps1'
      - '"warninglevel_18412_audit : $WARNINGLEVEL"'
    tags:
      - warninglevel
      - eighteen
      - 18.4.12
      - all

  - name: Transfering turnoffmulticastname audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffmulticastname_18541_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffmulticastname
      - eighteen
      - 18.5.4.1
      - all

  - name: Adding turnoffmulticastname in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFMULTICASTNAME = C:\facts\turnoffmulticastname_18541_audit.ps1'
      - '"turnoffmulticastname_18541_audit : $TURNOFFMULTICASTNAME"'
    tags:
      - turnoffmulticastname
      - eighteen
      - 18.5.4.1
      - all

  - name: Transfering mapperiodriver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/mapperiodriver_18591_audit.ps1
      dest: c:\facts\
    tags:
      - mapperiodriver
      - 18.5.9.1
      - eighteen
      - all

  - name: Adding mapperiodriver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MAPPERIODRIVER = C:\facts\mapperiodriver_18591_audit.ps1'
      - '"mapperiodriver_18591_audit : $MAPPERIODRIVER"'
    tags:
      - mapperiodriver
      - 18.5.9.1
      - eighteen
      - all

  - name: Transfering responderdriver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/responderdriver_18592_audit.ps1
      dest: c:\facts\
    tags:
      - responderdriver
      - 18.5.9.2
      - eighteen
      - all

  - name: Adding responderdriver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RESPONDERDRIVER = C:\facts\responderdriver_18592_audit.ps1'
      - '"responderdriver_18592_audit : $RESPONDERDRIVER"'
    tags:
      - responderdriver
      - 18.5.9.2
      - eighteen
      - all

  - name: Transfering mspeernetserv audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/mspeernetserv_185101_audit.ps1
      dest: c:\facts\
    tags:
      - mspeernetserv
      - 18.5.10.1
      - eighteen
      - all

  - name: Adding mspeernetserv in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MSPEERNETSERV = C:\facts\mspeernetserv_185101_audit.ps1'
      - '"mspeernetserv_185101_audit : $MSPEERNETSERV"'
    tags:
      - mspeernetserv
      - 18.5.10.1
      - eighteen
      - all

  - name: Transfering confnetbridge audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confnetbridge_185111_audit.ps1
      dest: c:\facts\
    tags:
      - confnetbridge
      - 18.5.11.1
      - eighteen
      - all

  - name: Adding confnetbridge in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFNETBRIDGE = C:\facts\confnetbridge_185111_audit.ps1'
      - '"confnetbridge_185111_audit : $CONFNETBRIDGE"'
    tags:
      - confnetbridge
      - 18.5.11.1
      - eighteen
      - all

  - name: Transfering domainusrnetloc audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/domainusrnetloc_185112_audit.ps1
      dest: c:\facts\
    tags:
      - domainusrnetloc
      - 18.5.11.2
      - eighteen
      - all

  - name: Adding domainusrnetloc in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DOMAINUSRNETLOC = C:\facts\domainusrnetloc_185112_audit.ps1'
      - '"domainusrnetloc_185112_audit : $DOMAINUSRNETLOC"'
    tags:
      - domainusrnetloc
      - 18.5.11.2
      - eighteen
      - all
      
  - name: Transfering hardeneduncpath audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/hardeneduncpath_185141_audit.ps1
      dest: c:\facts\
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all

  - name: Adding hardeneduncpath in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$HARDENEDUNCPATH = C:\facts\hardeneduncpath_185141_audit.ps1'
      - '"hardeneduncpath_185141_audit : $HARDENEDUNCPATH"'
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all

  - name: Transfering disableipv6 audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/disableipv6_1851921_audit.ps1
      dest: c:\facts\
    tags:
      - disableipv6
      - 18.5.19.2.1
      - eighteen
      - all

  - name: Adding disableipv6 in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISABLEIPV6 = C:\facts\disableipv6_1851921_audit.ps1'
      - '"disableipv6_1851921_audit : $DISABLEIPV6"'
    tags:
      - disableipv6
      - 18.5.19.2.1
      - eighteen
      - all

  - name: Transfering confwirelessset audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confwirelessset_185201_audit.ps1
      dest: c:\facts\
    tags:
      - confwirelessset
      - 18.5.20.1
      - eighteen
      - all

  - name: Adding confwirelessset in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFWIRELESSSET = C:\facts\confwirelessset_185201_audit.ps1'
      - '"confwirelessset_185201_audit : $CONFWIRELESSSET"'
    tags:
      - confwirelessset
      - 18.5.20.1
      - eighteen
      - all

  - name: Transfering winsconnectnowwiz audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/winsconnectnowwiz_185202_audit.ps1
      dest: c:\facts\
    tags:
      - winsconnectnowwiz
      - 18.5.20.2
      - eighteen
      - all

  - name: Adding winsconnectnowwiz in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$WINSCONNECTNOWWIZ = C:\facts\winsconnectnowwiz_185202_audit.ps1'
      - '"winsconnectnowwiz_185202_audit : $WINSCONNECTNOWWIZ"'
    tags:
      - winsconnectnowwiz
      - 18.5.20.2
      - eighteen
      - all

  - name: Transfering minimizeinetconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/minimizeinetconn_185211_audit.ps1
      dest: c:\facts\
    tags:
      - minimizeinetconn
      - 18.5.21.1
      - eighteen
      - all

  - name: Adding minimizeinetconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MINIMIZEINETCONN = C:\facts\minimizeinetconn_185211_audit.ps1'
      - '"minimizeinetconn_185211_audit : $MINIMIZEINETCONN"'
    tags:
      - minimizeinetconn
      - 18.5.21.1
      - eighteen
      - all
  
  - name: Transfering prohconnnondomnet audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/prohconnnondomnet_185212_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - prohconnnondomnet
      - 18.5.21.2
      - eighteen
      - all

  - name: Adding prohconnnondomnet in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PROHCONNNONDOMNET = C:\facts\prohconnnondomnet_185212_audit.ps1'
      - '"prohconnnondomnet_185212_audit : $PROHCONNNONDOMNET"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - prohconnnondomnet
      - 18.5.21.2
      - eighteen
      - all
   
  - name: Transfering offnotifnetusage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/offnotifnetusage_18711_audit.ps1
      dest: c:\facts\
    tags:
      - offnotifnetusage
      - 18.7.1.1
      - eighteen
      - all

  - name: Adding offnotifnetusage in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$OFFNOTIFNETUSAGE = C:\facts\offnotifnetusage_18711_audit.ps1'
      - '"offnotifnetusage_18711_audit : $OFFNOTIFNETUSAGE"'
    tags:
      - offnotifnetusage
      - 18.7.1.1
      - eighteen
      - all
   
  - name: Transfering cmdlineprocesscreate audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/cmdlineprocesscreate_18831_audit.ps1
      dest: c:\facts\
    tags:
      - cmdlineprocesscreate
      - 18.8.3.1
      - eighteen
      - all

  - name: Adding cmdlineprocesscreate in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CMDLINEPROCESSCREATE = C:\facts\cmdlineprocesscreate_18831_audit.ps1'
      - '"cmdlineprocesscreate_18831_audit : $CMDLINEPROCESSCREATE"'
    tags:
      - cmdlineprocesscreate
      - 18.8.3.1
      - eighteen
      - all
      
  - name: Transfering encryptoraclerem audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/encryptoraclerem_18841_audit.ps1
      dest: c:\facts\
    tags:
      - encryptoraclerem
      - 18.8.4.1
      - eighteen
      - all

  - name: Adding encryptoraclerem in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENCRYPTORACLEREM = C:\facts\encryptoraclerem_18841_audit.ps1'
      - '"encryptoraclerem_18841_audit : $ENCRYPTORACLEREM"'
    tags:
      - encryptoraclerem
      - 18.8.4.1
      - eighteen
      - all

      
  - name: Transfering bootstartdrivpolicy audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/bootstartdrivpolicy_188141_audit.ps1
      dest: c:\facts\
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all

  - name: Adding bootstartdrivpolicy in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$BOOTSTARTDRIVPOLICY = C:\facts\bootstartdrivpolicy_188141_audit.ps1'
      - '"bootstartdrivpolicy_188141_audit : $BOOTSTARTDRIVPOLICY"'
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all

  - name: Transfering regpolbackgrdprocess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/regpolbackgrdprocess_188211_audit.ps1
      dest: c:\facts\
    tags:
      - regpolbackgrdprocess
      - 18.8.21.1
      - eighteen
      - all

  - name: Adding regpolbackgrdprocess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REGPOLBACKGRDPROCESS = C:\facts\regpolbackgrdprocess_188211_audit.ps1'
      - '"regpolbackgrdprocess_188211_audit : $REGPOLBACKGRDPROCESS"'
    tags:
      - regpolbackgrdprocess
      - 18.8.21.1
      - eighteen
      - all

  - name: Transfering regpolgrppolicychg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/regpolgrppolicychg_188212_audit.ps1
      dest: c:\facts\
    tags:
      - regpolgrppolicychg
      - 18.8.21.2
      - eighteen
      - all

  - name: Adding regpolgrppolicychg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$REGPOLGRPPOLICYCHG = C:\facts\regpolgrppolicychg_188212_audit.ps1'
      - '"regpolgrppolicychg_188212_audit : $REGPOLGRPPOLICYCHG"'
    tags:
      - regpolgrppolicychg
      - 18.8.21.2
      - eighteen
      - all

  - name: Transfering backgrprefresh audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/backgrprefresh_188213_audit.ps1
      dest: c:\facts\
    tags:
      - backgrprefresh
      - 18.8.21.3
      - eighteen
      - all

  - name: Adding backgrprefresh in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$BACKGRPREFRESH = C:\facts\backgrprefresh_188213_audit.ps1'
      - '"backgrprefresh_188213_audit : $BACKGRPREFRESH"'
    tags:
      - backgrprefresh
      - 18.8.21.3
      - eighteen
      - all

  - name: Transfering turnoffprintdriver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffprintdriver_1882211_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all

  - name: Adding turnoffprintdriver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFPRINTDRIVER = C:\facts\turnoffprintdriver_1882211_audit.ps1'
      - '"turnoffprintdriver_1882211_audit : $TURNOFFPRINTDRIVER"'
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all

  - name: Transfering turnoffdatasharing audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffdatasharing_1882212_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all

  - name: Adding turnoffdatasharing in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFDATASHARING = C:\facts\turnoffdatasharing_1882212_audit.ps1'
      - '"turnoffdatasharing_1882212_audit : $TURNOFFDATASHARING"'
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all
      
  - name: Transfering turnofferrorreport audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnofferrorreport_1882213_audit.ps1
      dest: c:\facts\
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all

  - name: Adding turnofferrorreport in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFERRORREPORT = C:\facts\turnofferrorreport_1882213_audit.ps1'
      - '"turnofferrorreport_1882213_audit : $TURNOFFERRORREPORT"'
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all

  - name: Transfering turnoffinetconnwiz audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffinetconnwiz_1882214_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all

  - name: Adding turnoffinetconnwiz in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFINETCONNWIZ = C:\facts\turnoffinetconnwiz_1882214_audit.ps1'
      - '"turnoffinetconnwiz_1882214_audit : $TURNOFFINETCONNWIZ"'
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all

  - name: Transfering turnoffinetdownload audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffinetdownload_1882215_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all

  - name: Adding turnoffinetdownload in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFINETDOWNLOAD = C:\facts\turnoffinetdownload_1882215_audit.ps1'
      - '"turnoffinetdownload_1882215_audit : $TURNOFFINETDOWNLOAD"'
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all

  - name: Transfering turnoffprinting audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffprinting_1882216_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all

  - name: Adding turnoffprinting in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFPRINTING = C:\facts\turnoffprinting_1882216_audit.ps1'
      - '"turnoffprinting_1882216_audit : $TURNOFFPRINTING"'
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all

  - name: Transfering turnoffregistry audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffregistry_1882217_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all

  - name: Adding turnoffregistry in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFREGISTRY = C:\facts\turnoffregistry_1882217_audit.ps1'
      - '"turnoffregistry_1882217_audit : $TURNOFFREGISTRY"'
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all

  - name: Transfering turnoffsearchcomp audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffsearchcomp_1882218_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffsearchcomp
      - 18.8.22.1.8
      - eighteen
      - all

  - name: Adding turnoffsearchcomp in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFSEARCHCOMP = C:\facts\turnoffsearchcomp_1882218_audit.ps1'
      - '"turnoffsearchcomp_1882218_audit : $TURNOFFSEARCHCOMP"'
    tags:
      - turnoffsearchcomp
      - 18.8.22.1.8
      - eighteen
      - all

  - name: Transfering turnofforderprints audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnofforderprints_1882219_audit.ps1
      dest: c:\facts\
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all

  - name: Adding turnofforderprints in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFORDERPRINTS = C:\facts\turnofforderprints_1882219_audit.ps1'
      - '"turnofforderprints_1882219_audit : $TURNOFFORDERPRINTS"'
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all

  - name: Transfering turnoffpublishweb audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffpublishweb_18822110_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all

  - name: Adding turnoffpublishweb in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFPUBLISHWEB = C:\facts\turnoffpublishweb_18822110_audit.ps1'
      - '"turnoffpublishweb_18822110_audit : $TURNOFFPUBLISHWEB"'
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all

  - name: Transfering turnoffwmceip audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffwmceip_18822111_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffwmceip
      - 18.8.22.1.11
      - eighteen
      - all

  - name: Adding turnoffwmceip in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFWMCEIP = C:\facts\turnoffwmceip_18822111_audit.ps1'
      - '"turnoffwmceip_18822111_audit : $TURNOFFWMCEIP"'
    tags:
      - turnoffwmceip
      - 18.8.22.1.11
      - eighteen
      - all

  - name: Transfering turnoffwceip audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffwceip_18822112_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffwceip
      - 18.8.22.1.12
      - eighteen
      - all

  - name: Adding turnoffwceip in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFWCEIP = C:\facts\turnoffwceip_18822112_audit.ps1'
      - '"turnoffwceip_18822112_audit : $TURNOFFWCEIP"'
    tags:
      - turnoffwceip
      - 18.8.22.1.12
      - eighteen
      - all

  - name: Transfering turnoffwinerrorep audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffwinerrorep_18822113_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffwinerrorep
      - 18.8.22.1.13
      - eighteen
      - all

  - name: Adding turnoffwinerrorep in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFWINERROREP = C:\facts\turnoffwinerrorep_18822113_audit.ps1'
      - '"turnoffwinerrorep_18822113_audit : $TURNOFFWINERROREP"'
    tags:
      - turnoffwinerrorep
      - 18.8.22.1.13
      - eighteen
      - all

  - name: Transfering disallowcopyusrinput audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/disallowcopyusrinput_188271_audit.ps1
      dest: c:\facts\
    tags:
      - 18.8.27.1
      - disallowcopyusrinput
      - eighteen
      - all

  - name: Adding disallowcopyusrinput in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISALLOWCOPYUSRINPUT = C:\facts\disallowcopyusrinput_188271_audit.ps1'
      - '"disallowcopyusrinput_188271_audit : $DISALLOWCOPYUSRINPUT"'
    tags:
      - 18.8.27.1
      - disallowcopyusrinput
      - eighteen
      - all
      
  - name: Transfering dontdisplaynetui audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontdisplaynetui_188281_audit.ps1
      dest: c:\facts\
    tags:
      - 18.8.28.1
      - dontdisplaynetui
      - eighteen
      - all

  - name: Adding dontdisplaynetui in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTDISPLAYNETUI = C:\facts\dontdisplaynetui_188281_audit.ps1'
      - '"dontdisplaynetui_188281_audit : $DONTDISPLAYNETUI"'
    tags:
      - 18.8.28.1
      - dontdisplaynetui
      - eighteen
      - all

  - name: Transfering dontenumconnusre audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontenumconnusr_188282_audit.ps1
      dest: c:\facts\
    tags:
      - 18.8.28.2
      - dontenumconnusr
      - eighteen
      - all

  - name: Adding dontenumconnusr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTENUMCONNUSR = C:\facts\dontenumconnusr_188282_audit.ps1'
      - '"dontenumconnusr_188282_audit : $DONTENUMCONNUSR"'
    tags:
      - 18.8.28.2
      - dontenumconnusr
      - eighteen
      - all
      
  - name: Transfering enumlocalusr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enumlocalusr_188283_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - 18.8.28.3
      - enumlocalusr
      - eighteen
      - all

  - name: Adding enumlocalusr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENUMLOCALUSR = C:\facts\enumlocalusr_188283_audit.ps1'
      - '"enumlocalusr_188283_audit : $ENUMLOCALUSR"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - 18.8.28.3
      - enumlocalusr
      - eighteen
      - all

  - name: Transfering turnoffappnotfic audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffappnotfic_188284_audit.ps1
      dest: c:\facts\
    tags:
      - 18.8.28.4
      - turnoffappnotfic
      - eighteen
      - all

  - name: Adding turnoffappnotfic in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFAPPNOTFIC = C:\facts\turnoffappnotfic_188284_audit.ps1'
      - '"turnoffappnotfic_188284_audit : $TURNOFFAPPNOTFIC"'
    tags:
      - 18.8.28.4
      - turnoffappnotfic
      - eighteen
      - all
  
  - name: Transfering turnoffpicpwdsignin audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffpicpwdsignin_188285_audit.ps1
      dest: c:\facts\
    tags:
      - 18.8.28.5
      - turnoffpicpwdsignin
      - eighteen
      - all

  - name: Adding turnoffpicpwdsignin in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFPICPWDSIGNIN = C:\facts\turnoffpicpwdsignin_188285_audit.ps1'
      - '"turnoffpicpwdsignin_188285_audit : $TURNOFFPICPWDSIGNIN"'
    tags:
      - 18.8.28.5
      - turnoffpicpwdsignin
      - eighteen
      - all

  - name: Transfering turnoffpinsignin audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffpinsignin_188286_audit.ps1
      dest: c:\facts\
    tags:
      - 18.8.28.6
      - turnoffpinsignin
      - eighteen
      - all

  - name: Adding turnoffpinsignin in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFPINSIGNIN = C:\facts\turnoffpinsignin_188286_audit.ps1'
      - '"turnoffpinsignin_188286_audit : $TURNOFFPINSIGNIN"'
    tags:
      - 18.8.28.6
      - turnoffpinsignin
      - eighteen
      - all
      
  - name: Transfering pwdcompwakesonbattery audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdcompwakesonbattery_1883461_audit.ps1
      dest: c:\facts\
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.1
      - eighteen
      - all

  - name: Adding pwdcompwakesonbattery in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDCOMPWAKESONBATTERY = C:\facts\pwdcompwakesonbattery_1883461_audit.ps1'
      - '"pwdcompwakesonbattery_1883461_audit : $PWDCOMPWAKESONBATTERY"'
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.1
      - eighteen
      - all

  - name: Transfering pwdcompwakespluggedin audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdcompwakespluggedin_1883462_audit.ps1
      dest: c:\facts\
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.2
      - eighteen
      - all

  - name: Adding pwdcompwakespluggedin in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDCOMPWAKESPLUGGEDIN = C:\facts\pwdcompwakespluggedin_1883462_audit.ps1'
      - '"pwdcompwakespluggedin_1883462_audit : $PWDCOMPWAKESPLUGGEDIN"'
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.2
      - eighteen
      - all

  - name: Transfering confofferremoteassist audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confofferremoteassist_188361_audit.ps1
      dest: c:\facts\
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all

  - name: Adding confofferremoteassist in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFOFFERREMOTEASSIST = C:\facts\confofferremoteassist_188361_audit.ps1'
      - '"confofferremoteassist_188361_audit : $CONFOFFERREMOTEASSIST"'
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all

  - name: Transfering confsolicremoteassist audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confsolicremoteassist_188362_audit.ps1
      dest: c:\facts\
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all

  - name: Adding confsolicremoteassist in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFSOLICREMOTEASSIST = C:\facts\confsolicremoteassist_188362_audit.ps1'
      - '"confsolicremoteassist_188362_audit : $CONFSOLICREMOTEASSIST"'
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all

  - name: Transfering rpcemcliauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/rpcemcliauthen_188371_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all

  - name: Adding rpcemcliauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RPCEMCLIAUTHEN = C:\facts\rpcemcliauthen_188371_audit.ps1'
      - '"rpcemcliauthen_188371_audit : $RPCEMCLIAUTHEN"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all

  - name: Transfering unauthenrpccli audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/unauthenrpccli_188372_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - unauthenrpccli
      - 18.8.37.2
      - eighteen
      - all

  - name: Adding unauthenrpccli in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$UNAUTHENRPCCLI = C:\facts\unauthenrpccli_188372_audit.ps1'
      - '"unauthenrpccli_188372_audit : $UNAUTHENRPCCLI"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - unauthenrpccli
      - 18.8.37.2
      - eighteen
      - all

  - name: Transfering msdiagnostictool audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/msdiagnostictool_1884751_audit.ps1
      dest: c:\facts\
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all

  - name: Adding msdiagnostictool in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$MSDIAGNOSTICTOOL = C:\facts\msdiagnostictool_1884751_audit.ps1'
      - '"msdiagnostictool_1884751_audit : $MSDIAGNOSTICTOOL"'
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all

  - name: Transfering perftrack audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/perftrack_18847111_audit.ps1
      dest: c:\facts\
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all

  - name: Adding perftrack in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PERFTRACK = C:\facts\perftrack_18847111_audit.ps1'
      - '"perftrack_18847111_audit : $PERFTRACK"'
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all

      
  - name: Transfering enablewinntpcli audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enablewinntpcli_1885211_audit.ps1
      dest: c:\facts\
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all

  - name: Adding enablewinntpcli in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENABLEWINNTPCLI = C:\facts\enablewinntpcli_1885211_audit.ps1'
      - '"enablewinntpcli_1885211_audit : $ENABLEWINNTPCLI"'
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all

  - name: Transfering enablewinntpserv audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enablewinntpserv_1885212_audit.ps1
      dest: c:\facts\
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all

  - name: Adding enablewinntpserv in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENABLEWINNTPSERV = C:\facts\enablewinntpserv_1885212_audit.ps1'
      - '"enablewinntpserv_1885212_audit : $ENABLEWINNTPSERV"'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'  
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all

   
  - name: Transfering autoplaynonvoldev audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/autoplaynonvoldev_18981_audit.ps1
      dest: c:\facts\
    tags:
      - autoplaynonvoldev
      - 18.9.8.1
      - eighteen
      - all

  - name: Adding autoplaynonvoldev in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$AUTOPLAYNONVOLDEV = C:\facts\autoplaynonvoldev_18981_audit.ps1'
      - '"autoplaynonvoldev_18981_audit : $AUTOPLAYNONVOLDEV"'
    tags:
      - autoplaynonvoldev
      - 18.9.8.1
      - eighteen
      - all
      
  - name: Transfering defaultautorun audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/defaultautorun_18982_audit.ps1
      dest: c:\facts\
    tags:
      - defaultautorun
      - 18.9.8.2
      - eighteen
      - all

  - name: Adding defaultautorun in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DEFAULTAUTORUN = C:\facts\defaultautorun_18982_audit.ps1'
      - '"defaultautorun_18982_audit : $DEFAULTAUTORUN"'
    tags:
      - defaultautorun
      - 18.9.8.2
      - eighteen
      - all

  - name: Transfering turnoffautoplay audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffautoplay_18983_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffautoplay
      - 18.9.8.3
      - eighteen
      - all

  - name: Adding turnoffautoplay in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFAUTOPLAY = C:\facts\turnoffautoplay_18983_audit.ps1'
      - '"turnoffautoplay_18983_audit : $TURNOFFAUTOPLAY"'
    tags:
      - turnoffautoplay
      - 18.9.8.3
      - eighteen
      - all

  - name: Transfering pwdrevealbutton audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdrevealbutton_189151_audit.ps1
      dest: c:\facts\
    tags:
      - pwdrevealbutton
      - 18.9.15.1
      - eighteen
      - all

  - name: Adding pwdrevealbutton in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDREVEALBUTTON = C:\facts\pwdrevealbutton_189151_audit.ps1'
      - '"pwdrevealbutton_189151_audit : $PWDREVEALBUTTON"'
    tags:
      - pwdrevealbutton
      - 18.9.15.1
      - eighteen
      - all

  - name: Transfering admaccelevation audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/admaccelevation_189152_audit.ps1
      dest: c:\facts\
    tags:
      - admaccelevation
      - 18.9.15.2
      - eighteen
      - all

  - name: Adding admaccelevation in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ADMACCELEVATION = C:\facts\admaccelevation_189152_audit.ps1'
      - '"admaccelevation_189152_audit : $ADMACCELEVATION"'
    tags:
      - admaccelevation
      - 18.9.15.2
      - eighteen
      - all

  - name: Transfering emet audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/emet_189241_audit.ps1
      dest: c:\facts\
    tags:
      - emet
      - 18.9.24.1
      - eighteen
      - all

  - name: Adding emet in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$EMET = C:\facts\emet_189241_audit.ps1'
      - '"emet_189241_audit : $EMET"'
    tags:
      - emet
      - 18.9.24.1
      - eighteen
      - all

  - name: Transfering enmitigationsetting audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enmitigationsetting_189242_audit.ps1
      dest: c:\facts\
    tags:
      - enmitigationsetting
      - 18.9.24.2
      - eighteen
      - all

  - name: Adding enmitigationsetting in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENMITIGATIONSETTING = C:\facts\enmitigationsetting_189242_audit.ps1'
      - '"enmitigationsetting_189242_audit : $ENMITIGATIONSETTING"'
    tags:
      - enmitigationsetting
      - 18.9.24.2
      - eighteen
      - all

  - name: Transfering endefaultie audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/endefaultie_189243_audit.ps1
      dest: c:\facts\
    tags:
      - endefaultie
      - 18.9.24.3
      - eighteen
      - all

  - name: Adding endefaultie in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENDEFAULTIE = C:\facts\endefaultie_189243_audit.ps1'
      - '"endefaultie_189243_audit : $ENDEFAULTIE"'
    tags:
      - endefaultie
      - 18.9.24.3
      - eighteen
      - all

  - name: Transfering endefpopsoftware audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/endefpopsoftware_189244_audit.ps1
      dest: c:\facts\
    tags:
      - endefpopsoftware
      - 18.9.24.4
      - eighteen
      - all

  - name: Adding endefpopsoftware in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENDEFPOPSOFTWARE = C:\facts\endefpopsoftware_189244_audit.ps1'
      - '"endefpopsoftware_189244_audit : $ENDEFPOPSOFTWARE"'
    tags:
      - endefpopsoftware
      - 18.9.24.4
      - eighteen
      - all

  - name: Transfering endefrecsofware audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/endefrecsofware_189245_audit.ps1
      dest: c:\facts\
    tags:
      - endefrecsofware
      - 18.9.24.5
      - eighteen
      - all

  - name: Adding endefrecsofware in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENDEFRECSOFWARE = C:\facts\endefrecsofware_189245_audit.ps1'
      - '"endefrecsofware_189245_audit : $ENDEFRECSOFWARE"'
    tags:
      - endefrecsofware
      - 18.9.24.5
      - eighteen
      - all

  - name: Transfering enappoptinaslr audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enappoptinaslr_189246_audit.ps1
      dest: c:\facts\
    tags:
      - enappoptinaslr
      - 18.9.24.6
      - eighteen
      - all

  - name: Adding enappoptinaslr in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENAPPOPTINASLR = C:\facts\enappoptinaslr_189246_audit.ps1'
      - '"enappoptinaslr_189246_audit : $ENAPPOPTINASLR"'
    tags:
      - enappoptinaslr
      - 18.9.24.6
      - eighteen
      - all

  - name: Transfering enappoptoutdep audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enappoptoutdep_189247_audit.ps1
      dest: c:\facts\
    tags:
      - enappoptoutdep
      - 18.9.24.7
      - eighteen
      - all

  - name: Adding enappoptoutdep in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENAPPOPTOUTDEP = C:\facts\enappoptoutdep_189247_audit.ps1'
      - '"enappoptoutdep_189247_audit : $ENAPPOPTOUTDEP"'
    tags:
      - enappoptoutdep
      - 18.9.24.7
      - eighteen
      - all

  - name: Transfering enappoptoutsehop audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enappoptoutsehop_189248_audit.ps1
      dest: c:\facts\
    tags:
      - enappoptoutsehop
      - 18.9.24.8
      - eighteen
      - all

  - name: Adding enappoptoutsehop in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENAPPOPTOUTSEHOP = C:\facts\enappoptoutsehop_189248_audit.ps1'
      - '"enappoptoutsehop_189248_audit : $ENAPPOPTOUTSEHOP"'
    tags:
      - enappoptoutsehop
      - 18.9.24.8
      - eighteen
      - all

  - name: Transfering appcontroleventlog audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/appcontroleventlog_1892611_audit.ps1
      dest: c:\facts\
    tags:
      - appcontroleventlog
      - 18.9.26.1.1
      - eighteen
      - all

  - name: Adding appcontroleventlog in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$APPCONTROLEVENTLOG = C:\facts\appcontroleventlog_1892611_audit.ps1'
      - '"appcontroleventlog_1892611_audit : $APPCONTROLEVENTLOG"'
    tags:
      - appcontroleventlog
      - 18.9.26.1.1
      - eighteen
      - all

  - name: Transfering appmaxlogfilesize audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/appmaxlogfilesize_1892612_audit.ps1
      dest: c:\facts\
    tags:
      - appmaxlogfilesize
      - 18.9.26.1.2
      - eighteen
      - all

  - name: Adding appmaxlogfilesize in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$APPMAXLOGFILESIZE = C:\facts\appmaxlogfilesize_1892612_audit.ps1'
      - '"appmaxlogfilesize_1892612_audit : $APPMAXLOGFILESIZE"'
    tags:
      - appmaxlogfilesize
      - 18.9.26.1.2
      - eighteen
      - all

  - name: Transfering securcontroleventlog audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/securcontroleventlog_1892621_audit.ps1
      dest: c:\facts\
    tags:
      - securcontroleventlog
      - 18.9.26.2.1
      - eighteen
      - all

  - name: Adding securcontroleventlog in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SECURCONTROLEVENTLOG = C:\facts\securcontroleventlog_1892621_audit.ps1'
      - '"securcontroleventlog_1892621_audit : $SECURCONTROLEVENTLOG"'
    tags:
      - securcontroleventlog
      - 18.9.26.2.1
      - eighteen
      - all

  - name: Transfering securmaxlogfilesize audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/securmaxlogfilesize_1892622_audit.ps1
      dest: c:\facts\
    tags:
      - securmaxlogfilesize
      - 18.9.26.2.2
      - eighteen
      - all

  - name: Adding securmaxlogfilesize in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SECURMAXLOGFILESIZE = C:\facts\securmaxlogfilesize_1892622_audit.ps1'
      - '"securmaxlogfilesize_1892622_audit : $SECURMAXLOGFILESIZE"'
    tags:
      - securmaxlogfilesize
      - 18.9.26.2.2
      - eighteen
      - all

  - name: Transfering setupcontroleventlog audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/setupcontroleventlog_1892631_audit.ps1
      dest: c:\facts\
    tags:
      - setupcontroleventlog
      - 18.9.26.3.1
      - eighteen
      - all

  - name: Adding setupcontroleventlog in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SETUPCONTROLEVENTLOG = C:\facts\setupcontroleventlog_1892631_audit.ps1'
      - '"setupcontroleventlog_1892631_audit : $SETUPCONTROLEVENTLOG"'
    tags:
      - setupcontroleventlog
      - 18.9.26.3.1
      - eighteen
      - all

  - name: Transfering setupmaxlogfilesize audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/setupmaxlogfilesize_1892632_audit.ps1
      dest: c:\facts\
    tags:
      - setupmaxlogfilesize
      - 18.9.26.3.2
      - eighteen
      - all

  - name: Adding setupmaxlogfilesize in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SETUPMAXLOGFILESIZE = C:\facts\setupmaxlogfilesize_1892632_audit.ps1'
      - '"setupmaxlogfilesize_1892632_audit : $SETUPMAXLOGFILESIZE"'
    tags:
      - setupmaxlogfilesize
      - 18.9.26.3.2
      - eighteen
      - all

  - name: Transfering syscontroleventlog audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/syscontroleventlog_1892641_audit.ps1
      dest: c:\facts\
    tags:
      - syscontroleventlog
      - 18.9.26.4.1
      - eighteen
      - all

  - name: Adding syscontroleventlog in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SYSCONTROLEVENTLOG = C:\facts\syscontroleventlog_1892641_audit.ps1'
      - '"syscontroleventlog_1892641_audit : $SYSCONTROLEVENTLOG"'
    tags:
      - syscontroleventlog
      - 18.9.26.4.1
      - eighteen
      - all

  - name: Transfering sysmaxlogfilesize audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/sysmaxlogfilesize_1892642_audit.ps1
      dest: c:\facts\
    tags:
      - sysmaxlogfilesize
      - 18.9.26.4.2
      - eighteen
      - all

  - name: Adding sysmaxlogfilesize in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SYSMAXLOGFILESIZE = C:\facts\sysmaxlogfilesize_1892642_audit.ps1'
      - '"sysmaxlogfilesize_1892642_audit : $SYSMAXLOGFILESIZE"'
    tags:
      - sysmaxlogfilesize
      - 18.9.26.4.2
      - eighteen
      - all

  - name: Transfering turnoffdataexec audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffdataexec_189301_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffdataexec
      - 18.9.30.1
      - eighteen
      - all

  - name: Adding turnoffdataexec in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFDATAEXEC = C:\facts\turnoffdataexec_189301_audit.ps1'
      - '"turnoffdataexec_189301_audit : $TURNOFFDATAEXEC"'
    tags:
      - turnoffdataexec
      - 18.9.30.1
      - eighteen
      - all
      
  - name: Transfering turnoffheaptermination audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffheaptermination_189302_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffheaptermination
      - 18.9.30.2
      - eighteen
      - all

  - name: Adding turnoffheaptermination in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFHEAPTERMINATION = C:\facts\turnoffheaptermination_189302_audit.ps1'
      - '"turnoffheaptermination_189302_audit : $TURNOFFHEAPTERMINATION"'
    tags:
      - turnoffheaptermination
      - 18.9.30.2
      - eighteen
      - all

  - name: Transfering turnoffshellprotocol audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffshellprotocol_189303_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffshellprotocol
      - 18.9.30.3
      - eighteen
      - all

  - name: Adding turnoffshellprotocol in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFSHELLPROTOCOL = C:\facts\turnoffshellprotocol_189303_audit.ps1'
      - '"turnoffshellprotocol_189303_audit : $TURNOFFSHELLPROTOCOL"'
    tags:
      - turnoffshellprotocol
      - 18.9.30.3
      - eighteen
      - all

  - name: Transfering offwinlocprovider audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/offwinlocprovider_1893911_audit.ps1
      dest: c:\facts\
    tags:
      - offwinlocprovider
      - 18.9.39.1.1
      - eighteen
      - all

  - name: Adding offwinlocprovider in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$OFFWINLOCPROVIDER = C:\facts\offwinlocprovider_1893911_audit.ps1'
      - '"offwinlocprovider_1893911_audit : $OFFWINLOCPROVIDER"'
    tags:
      - offwinlocprovider
      - 18.9.39.1.1
      - eighteen
      - all
   
  - name: Transfering offwinlocprovider audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnofflocation_189392_audit.ps1
      dest: c:\facts\
    tags:
      - turnofflocation
      - 18.9.39.2
      - eighteen
      - all

  - name: Adding turnofflocation in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFLOCATION = C:\facts\turnofflocation_189392_audit.ps1'
      - '"turnofflocation_189392_audit : $TURNOFFLOCATION"'
    tags:
      - turnofflocation
      - 18.9.39.2
      - eighteen
      - all
   
  - name: Transfering preventonedriveusage audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/preventonedriveusage_189521_audit.ps1
      dest: c:\facts\
    tags:
      - preventonedriveusage
      - 18.9.52.1
      - eighteen
      - all

  - name: Adding preventonedriveusage in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVENTONEDRIVEUSAGE = C:\facts\preventonedriveusage_189521_audit.ps1'
      - '"preventonedriveusage_189521_audit : $PREVENTONEDRIVEUSAGE"'
    tags:
      - preventonedriveusage
      - 18.9.52.1
      - eighteen
      - all
  
  - name: Transfering preventonedrivewin81 audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/preventonedrivewin81_189522_audit.ps1
      dest: c:\facts\
    tags:
      - preventonedrivewin81
      - 18.9.52.2
      - eighteen
      - all

  - name: Adding preventonedrivewin81 in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVENTONEDRIVEWIN81 = C:\facts\preventonedrivewin81_189522_audit.ps1'
      - '"preventonedrivewin81_189522_audit : $PREVENTONEDRIVEWIN81"'
    tags:
      - preventonedrivewin81
      - 18.9.52.2
      - eighteen
      - all
      
  - name: Transfering dontallowpwdsaved audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowpwdsaved_1895922_audit.ps1
      dest: c:\facts\
    tags:
      - dontallowpwdsaved
      - 18.9.59.2.2
      - eighteen
      - all

  - name: Adding dontallowpwdsaved in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWPWDSAVED = C:\facts\dontallowpwdsaved_1895922_audit.ps1'
      - '"dontallowpwdsaved_1895922_audit : $DONTALLOWPWDSAVED"'
    tags:
      - dontallowpwdsaved
      - 18.9.59.2.2
      - eighteen
      - all

  - name: Transfering restrictremdesktopserv audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/restrictremdesktopserv_18959321_audit.ps1
      dest: c:\facts\
    tags:
      - restrictremdesktopserv
      - 18.9.59.3.2.1
      - eighteen
      - all

  - name: Adding restrictremdesktopserv in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$RESTRICTREMDESKTOPSERV = C:\facts\restrictremdesktopserv_18959321_audit.ps1'
      - '"restrictremdesktopserv_18959321_audit : $RESTRICTREMDESKTOPSERV"'
    tags:
      - restrictremdesktopserv
      - 18.9.59.3.2.1
      - eighteen
      - all

  - name: Transfering dontallowcomport audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowcomport_18959331_audit.ps1
      dest: c:\facts\
    tags:
      - dontallowcomport
      - 18.9.59.3.3.1
      - eighteen
      - all

  - name: Adding dontallowcomport in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWCOMPORT = C:\facts\dontallowcomport_18959331_audit.ps1'
      - '"dontallowcomport_18959331_audit : $DONTALLOWCOMPORT"'
    tags:
      - dontallowcomport
      - 18.9.59.3.3.1
      - eighteen
      - all

  - name: Transfering dontallowdrive audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowdrive_18959332_audit.ps1
      dest: c:\facts\
    tags:
      - dontallowdrive
      - 18.9.59.3.3.2
      - eighteen
      - all

  - name: Adding dontallowdrive in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWDRIVE = C:\facts\dontallowdrive_18959332_audit.ps1'
      - '"dontallowdrive_18959332_audit : $DONTALLOWDRIVE"'
    tags:
      - dontallowdrive
      - 18.9.59.3.3.2
      - eighteen
      - all

  - name: Transfering dontallowlptport audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowlptport_18959333_audit.ps1
      dest: c:\facts\
    tags:
      - dontallowlptport
      - 18.9.59.3.3.3
      - eighteen
      - all

  - name: Adding dontallowlptport in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWLPTPORT = C:\facts\dontallowlptport_18959333_audit.ps1'
      - '"dontallowlptport_18959333_audit : $DONTALLOWLPTPORT"'
    tags:
      - dontallowlptport
      - 18.9.59.3.3.3
      - eighteen
      - all

  - name: Transfering dontallowplugplaydev audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontallowplugplaydev_18959334_audit.ps1
      dest: c:\facts\
    tags:
      - dontallowplugplaydev
      - 18.9.59.3.3.4
      - eighteen
      - all

  - name: Adding dontallowplugplaydev in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTALLOWPLUGPLAYDEV = C:\facts\dontallowplugplaydev_18959334_audit.ps1'
      - '"dontallowplugplaydev_18959334_audit : $DONTALLOWPLUGPLAYDEV"'
    tags:
      - dontallowplugplaydev
      - 18.9.59.3.3.4
      - eighteen
      - all

  - name: Transfering pwdprompt audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pwdprompt_18959391_audit.ps1
      dest: c:\facts\
    tags:
      - pwdprompt
      - 18.9.59.3.9.1
      - eighteen
      - all

  - name: Adding pwdprompt in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PWDPROMPT = C:\facts\pwdprompt_18959391_audit.ps1'
      - '"pwdprompt_18959391_audit : $PWDPROMPT"'
    tags:
      - pwdprompt
      - 18.9.59.3.9.1
      - eighteen
      - all

  - name: Transfering securerpccommunic audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/securerpccommunic_18959392_audit.ps1
      dest: c:\facts\
    tags:
      - securerpccommunic
      - 18.9.59.3.9.2
      - eighteen
      - all

  - name: Adding securerpccommunic in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SECURERPCCOMMUNIC = C:\facts\securerpccommunic_18959392_audit.ps1'
      - '"securerpccommunic_18959392_audit : $SECURERPCCOMMUNIC"'
    tags:
      - securerpccommunic
      - 18.9.59.3.9.2
      - eighteen
      - all

  - name: Transfering enablerdpssl audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enablerdpssl_18959393_audit.ps1
      dest: c:\facts\
    tags:
      - enablerdpssl
      - 18.9.59.3.9.3
      - eighteen
      - all

  - name: Adding enablerdpssl in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENABLERDPSSL = C:\facts\enablerdpssl_18959393_audit.ps1'
      - '"enablerdpssl_18959393_audit : $ENABLERDPSSL"'
    tags:
      - enablerdpssl
      - 18.9.59.3.9.3
      - eighteen
      - all

  - name: Transfering ennetlevelauth audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/ennetlevelauth_18959394_audit.ps1
      dest: c:\facts\
    tags:
      - ennetlevelauth
      - 18.9.59.3.9.4
      - eighteen
      - all

  - name: Adding ennetlevelauth in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENNETLEVELAUTH = C:\facts\ennetlevelauth_18959394_audit.ps1'
      - '"ennetlevelauth_18959394_audit : $ENNETLEVELAUTH"'
    tags:
      - ennetlevelauth
      - 18.9.59.3.9.4
      - eighteen
      - all

  - name: Transfering setclientconn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/setclientconn_18959395_audit.ps1
      dest: c:\facts\
    tags:
      - setclientconn
      - 18.9.59.3.9.5
      - eighteen
      - all

  - name: Adding setclientconn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SETCLIENTCONN = C:\facts\setclientconn_18959395_audit.ps1'
      - '"setclientconn_18959395_audit : $SETCLIENTCONN"'
    tags:
      - setclientconn
      - 18.9.59.3.9.5
      - eighteen
      - all

  - name: Transfering timelimitactive audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/timelimitactive_189593101_audit.ps1
      dest: c:\facts\
    tags:
      - timelimitactive
      - 18.9.59.3.10.1
      - eighteen
      - all

  - name: Adding timelimitactive in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TIMELIMITACTIVE = C:\facts\timelimitactive_189593101_audit.ps1'
      - '"timelimitactive_189593101_audit : $TIMELIMITACTIVE"'
    tags:
      - timelimitactive
      - 18.9.59.3.10.1
      - eighteen
      - all

  - name: Transfering timelimitdisconsession audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/timelimitdisconsession_189593102_audit.ps1
      dest: c:\facts\
    tags:
      - timelimitdisconsession
      - 18.9.59.3.10.2
      - eighteen
      - all

  - name: Adding timelimitdisconsession in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TIMELIMITDISCONSESSION = C:\facts\timelimitdisconsession_189593102_audit.ps1'
      - '"timelimitdisconsession_189593102_audit : $TIMELIMITDISCONSESSION"'
    tags:
      - timelimitdisconsession
      - 18.9.59.3.10.2
      - eighteen
      - all

  - name: Transfering dontdeltempfolder audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontdeltempfolder_189593111_audit.ps1
      dest: c:\facts\
    tags:
      - dontdeltempfolder
      - 18.9.59.3.11.1
      - eighteen
      - all

  - name: Adding dontdeltempfolder in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTDELTEMPFOLDER = C:\facts\dontdeltempfolder_189593111_audit.ps1'
      - '"dontdeltempfolder_189593111_audit : $DONTDELTEMPFOLDER"'
    tags:
      - dontdeltempfolder
      - 18.9.59.3.11.1
      - eighteen
      - all

  - name: Transfering dontusetempfolder audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/dontusetempfolder_189593112_audit.ps1
      dest: c:\facts\
    tags:
      - dontusetempfolder
      - 18.9.59.3.11.2
      - eighteen
      - all

  - name: Adding dontusetempfolder in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DONTUSETEMPFOLDER = C:\facts\dontusetempfolder_189593112_audit.ps1'
      - '"dontusetempfolder_189593112_audit : $DONTUSETEMPFOLDER"'
    tags:
      - dontusetempfolder
      - 18.9.59.3.11.2
      - eighteen
      - all

  - name: Transfering preventdownload audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/preventdownload_189601_audit.ps1
      dest: c:\facts\
    tags:
      - preventdownload
      - 18.9.60.1
      - eighteen
      - all

  - name: Adding preventdownload in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVENTDOWNLOAD = C:\facts\preventdownload_189601_audit.ps1'
      - '"preventdownload_189601_audit : $PREVENTDOWNLOAD"'
    tags:
      - preventdownload
      - 18.9.60.1
      - eighteen
      - all

  - name: Transfering allowindexencrypfile audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowindexencrypfile_189612_audit.ps1
      dest: c:\facts\
    tags:
      - allowindexencrypfile
      - 18.9.61.2
      - eighteen
      - all

  - name: Adding allowindexencrypfile in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWINDEXENCRYPFILE = C:\facts\allowindexencrypfile_189612_audit.ps1'
      - '"allowindexencrypfile_189612_audit : $ALLOWINDEXENCRYPFILE"'
    tags:
      - allowindexencrypfile
      - 18.9.61.2
      - eighteen
      - all

   
  - name: Transfering turnoffkmsclionline audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffkmsclionline_189661_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffkmsclionline
      - 18.9.66.1
      - eighteen
      - all

  - name: Adding turnoffkmsclionline in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFKMSCLIONLINE = C:\facts\turnoffkmsclionline_189661_audit.ps1'
      - '"turnoffkmsclionline_189661_audit : $TURNOFFKMSCLIONLINE"'
    tags:
      - turnoffkmsclionline
      - 18.9.66.1
      - eighteen
      - all
      
  - name: Transfering confmsmaps audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confmsmaps_1897731_audit.ps1
      dest: c:\facts\
    tags:
      - confmsmaps
      - 18.9.77.3.1
      - eighteen
      - all

  - name: Adding confmsmaps in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFMSMAPS = C:\facts\confmsmaps_1897731_audit.ps1'
      - '"confmsmaps_1897731_audit : $CONFMSMAPS"'
    tags:
      - confmsmaps
      - 18.9.77.3.1
      - eighteen
      - all

  - name: Transfering joinmsmaps audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/joinmsmaps_1897732_audit.ps1
      dest: c:\facts\
    tags:
      - joinmsmaps
      - 18.9.77.3.2
      - eighteen
      - all

  - name: Adding joinmsmaps in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$JOINMSMAPS = C:\facts\joinmsmaps_1897732_audit.ps1'
      - '"joinmsmaps_1897732_audit : $JOINMSMAPS"'
    tags:
      - joinmsmaps
      - 18.9.77.3.2
      - eighteen
      - all
  
  - name: Transfering turnonmonitoring audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnonmonitoring_1897771_audit.ps1
      dest: c:\facts\
    tags:
      - turnonmonitoring
      - 18.9.77.7.1
      - eighteen
      - all

  - name: Adding turnonmonitoring in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNONMONITORING = C:\facts\turnonmonitoring_1897771_audit.ps1'
      - '"turnonmonitoring_1897771_audit : $TURNONMONITORING"'
    tags:
      - turnonmonitoring
      - 18.9.77.7.1
      - eighteen
      - all
  
  - name: Transfering confwatsonevents audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confwatsonevents_1897791_audit.ps1
      dest: c:\facts\
    tags:
      - confwatsonevents
      - 18.9.77.9.1
      - eighteen
      - all

  - name: Adding confwatsonevents in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFWATSONEVENTS = C:\facts\confwatsonevents_1897791_audit.ps1'
      - '"confwatsonevents_1897791_audit : $CONFWATSONEVENTS"'
    tags:
      - confwatsonevents
      - 18.9.77.9.1
      - eighteen
      - all
  
  - name: Transfering scanremovabledriver audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/scanremovabledriver_18977101_audit.ps1
      dest: c:\facts\
    tags:
      - scanremovabledriver
      - 18.9.77.10.1
      - eighteen
      - all

  - name: Adding scanremovabledriver in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SCANREMOVABLEDRIVER = C:\facts\scanremovabledriver_18977101_audit.ps1'
      - '"scanremovabledriver_18977101_audit : $SCANREMOVABLEDRIVER"'
    tags:
      - scanremovabledriver
      - 18.9.77.10.1
      - eighteen
      - all
  
  - name: Transfering turnonemailscan audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnonemailscan_18977102_audit.ps1
      dest: c:\facts\
    tags:
      - turnonemailscan
      - 18.9.77.10.2
      - eighteen
      - all

  - name: Adding turnonemailscan in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNONEMAILSCAN = C:\facts\turnonemailscan_18977102_audit.ps1'
      - '"turnonemailscan_18977102_audit : $TURNONEMAILSCAN"'
    tags:
      - turnonemailscan
      - 18.9.77.10.2
      - eighteen
      - all
      
  - name: Transfering turnoffwindefenderantivirus audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/turnoffwindefenderantivirus_1897714_audit.ps1
      dest: c:\facts\
    tags:
      - turnoffwindefenderantivirus
      - 18.9.77.14
      - eighteen
      - all

  - name: Adding turnoffwindefenderantivirus in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TURNOFFWINDEFENDERANTIVIRUS = C:\facts\turnoffwindefenderantivirus_1897714_audit.ps1'
      - '"turnoffwindefenderantivirus_1897714_audit : $TURNOFFWINDEFENDERANTIVIRUS"'
    tags:
      - turnoffwindefenderantivirus
      - 18.9.77.14
      - eighteen
      - all

  - name: Transfering confwindefendsmartscreen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confwindefendsmartscreen_1898011_audit.ps1
      dest: c:\facts\
    tags:
      - confwindefendsmartscreen
      - 18.9.80.1.1
      - eighteen
      - all

  - name: Adding confwindefendsmartscreen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFWINDEFENDSMARTSCREEN = C:\facts\confwindefendsmartscreen_1898011_audit.ps1'
      - '"confwindefendsmartscreen_1898011_audit : $CONFWINDEFENDSMARTSCREEN"'
    tags:
      - confwindefendsmartscreen
      - 18.9.80.1.1
      - eighteen
      - all

  - name: Transfering confdefaultconsent audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confdefaultconsent_1898121_audit.ps1
      dest: c:\facts\
    tags:
      - confdefaultconsent
      - 18.9.81.2.1
      - eighteen
      - all

  - name: Adding confdefaultconsent in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFDEFAULTCONSENT = C:\facts\confdefaultconsent_1898121_audit.ps1'
      - '"confdefaultconsent_1898121_audit : $CONFDEFAULTCONSENT"'
    tags:
      - confdefaultconsent
      - 18.9.81.2.1
      - eighteen
      - all

      
  - name: Transfering allowusrcontrol audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowusrcontrol_189851_audit.ps1
      dest: c:\facts\
    tags:
      - allowusrcontrol
      - 18.9.85.1
      - eighteen
      - all

  - name: Adding allowusrcontrol in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWUSRCONTROL = C:\facts\allowusrcontrol_189851_audit.ps1'
      - '"allowusrcontrol_189851_audit : $ALLOWUSRCONTROL"'
    tags:
      - allowusrcontrol
      - 18.9.85.1
      - eighteen
      - all

  - name: Transfering elevatedprivil audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/elevatedprivil_189852_audit.ps1
      dest: c:\facts\
    tags:
      - elevatedprivil
      - 18.9.85.2
      - eighteen
      - all

  - name: Adding elevatedprivil in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ELEVATEDPRIVIL = C:\facts\elevatedprivil_189852_audit.ps1'
      - '"elevatedprivil_189852_audit : $ELEVATEDPRIVIL"'
    tags:
      - elevatedprivil
      - 18.9.85.2
      - eighteen
      - all

  - name: Transfering previesecurprompt audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/previesecurprompt_189853_audit.ps1
      dest: c:\facts\
    tags:
      - previesecurprompt
      - 18.9.85.3
      - eighteen
      - all

  - name: Adding previesecurprompt in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVIESECURPROMPT = C:\facts\previesecurprompt_189853_audit.ps1'
      - '"previesecurprompt_189853_audit : $PREVIESECURPROMPT"'
    tags:
      - previesecurprompt
      - 18.9.85.3
      - eighteen
      - all
      
  - name: Transfering pshellscriptblocklog audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pshellscriptblocklog_189951_audit.ps1
      dest: c:\facts\
    tags:
      - pshellscriptblocklog
      - 18.9.95.1
      - eighteen
      - all

  - name: Adding pshellscriptblocklog in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PSHELLSCRIPTBLOCKLOG = C:\facts\pshellscriptblocklog_189951_audit.ps1'
      - '"pshellscriptblocklog_189951_audit : $PSHELLSCRIPTBLOCKLOG"'
    tags:
      - pshellscriptblocklog
      - 18.9.95.1
      - eighteen
      - all

  - name: Transfering pshelltranscription audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/pshelltranscription_189952_audit.ps1
      dest: c:\facts\
    tags:
      - pshelltranscription
      - 18.9.95.2
      - eighteen
      - all

  - name: Adding pshelltranscription in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PSHELLTRANSCRIPTION = C:\facts\pshelltranscription_189952_audit.ps1'
      - '"pshelltranscription_189952_audit : $PSHELLTRANSCRIPTION"'
    tags:
      - pshelltranscription
      - 18.9.95.2
      - eighteen
      - all

  - name: Transfering allowbasicauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowbasicauthen_1899711_audit.ps1
      dest: c:\facts\
    tags:
      - allowbasicauthen
      - 18.9.97.1.1
      - eighteen
      - all

  - name: Adding allowbasicauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWBASICAUTHEN = C:\facts\allowbasicauthen_1899711_audit.ps1'
      - '"allowbasicauthen_1899711_audit : $ALLOWBASICAUTHEN"'
    tags:
      - allowbasicauthen
      - 18.9.97.1.1
      - eighteen
      - all

  - name: Transfering allowunencryptraffic audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowunencryptraffic_1899712_audit.ps1
      dest: c:\facts\
    tags:
      - allowunencryptraffic
      - 18.9.97.1.2
      - eighteen
      - all

  - name: Adding allowunencryptraffic in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWUNENCRYPTRAFFIC = C:\facts\allowunencryptraffic_1899712_audit.ps1'
      - '"allowunencryptraffic_1899712_audit : $ALLOWUNENCRYPTRAFFIC"'
    tags:
      - allowunencryptraffic
      - 18.9.97.1.2
      - eighteen
      - all

  - name: Transfering disallowdigestauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/disallowdigestauthen_1899713_audit.ps1
      dest: c:\facts\
    tags:
      - disallowdigestauthen
      - 18.9.97.1.3
      - eighteen
      - all

  - name: Adding disallowdigestauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISALLOWDIGESTAUTHEN = C:\facts\disallowdigestauthen_1899713_audit.ps1'
      - '"disallowdigestauthen_1899713_audit : $DISALLOWDIGESTAUTHEN"'
    tags:
      - disallowdigestauthen
      - 18.9.97.1.3
      - eighteen
      - all

  - name: Transfering winrmallowbasicauthen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/winrmallowbasicauthen_1899721_audit.ps1
      dest: c:\facts\
    tags:
      - winrmallowbasicauthen
      - 18.9.97.2.1
      - eighteen
      - all

  - name: Adding winrmallowbasicauthen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$WINRMALLOWBASICAUTHEN = C:\facts\winrmallowbasicauthen_1899721_audit.ps1'
      - '"winrmallowbasicauthen_1899721_audit : $WINRMALLOWBASICAUTHEN"'
    tags:
      - winrmallowbasicauthen
      - 18.9.97.2.1
      - eighteen
      - all

  - name: Transfering allowremoteservmanagment audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowremoteservmanagment_1899722_audit.ps1
      dest: c:\facts\
    tags:
      - allowremoteservmanagment
      - 18.9.97.2.2
      - eighteen
      - all

  - name: Adding allowremoteservmanagment in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWREMOTESERVMANAGMENT = C:\facts\allowremoteservmanagment_1899722_audit.ps1'
      - '"allowremoteservmanagment_1899722_audit : $ALLOWREMOTESERVMANAGMENT"'
    tags:
      - allowremoteservmanagment
      - 18.9.97.2.2
      - eighteen
      - all

  - name: Transfering winrmallowencryptraffic audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/winrmallowencryptraffic_1899723_audit.ps1
      dest: c:\facts\
    tags:
      - winrmallowencryptraffic
      - 18.9.97.2.3
      - eighteen
      - all

  - name: Adding winrmallowencryptraffic in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$WINRMALLOWENCRYPTRAFFIC = C:\facts\winrmallowencryptraffic_1899723_audit.ps1'
      - '"winrmallowencryptraffic_1899723_audit : $WINRMALLOWENCRYPTRAFFIC"'
    tags:
      - winrmallowencryptraffic
      - 18.9.97.2.3
      - eighteen
      - all

  - name: Transfering disallowwinrm audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/disallowwinrm_1899724_audit.ps1
      dest: c:\facts\
    tags:
      - disallowwinrm
      - 18.9.97.2.4
      - eighteen
      - all

  - name: Adding disallowwinrm in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$DISALLOWWINRM = C:\facts\disallowwinrm_1899724_audit.ps1'
      - '"disallowwinrm_1899724_audit : $DISALLOWWINRM"'
    tags:
      - disallowwinrm
      - 18.9.97.2.4
      - eighteen
      - all

  - name: Transfering allowremoteshellaccess audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/allowremoteshellaccess_189981_audit.ps1
      dest: c:\facts\
    tags:
      - allowremoteshellaccess
      - 18.9.98.1
      - eighteen
      - all

  - name: Adding allowremoteshellaccess in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ALLOWREMOTESHELLACCESS = C:\facts\allowremoteshellaccess_189981_audit.ps1'
      - '"allowremoteshellaccess_189981_audit : $ALLOWREMOTESHELLACCESS"'
    tags:
      - allowremoteshellaccess
      - 18.9.98.1
      - eighteen
      - all

  - name: Transfering confautoupdates audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confautoupdates_1891021_audit.ps1
      dest: c:\facts\
    tags:
      - confautoupdates
      - 18.9.102.1
      - eighteen
      - all

  - name: Adding confautoupdates in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFAUTOUPDATES = C:\facts\confautoupdates_1891021_audit.ps1'
      - '"confautoupdates_1891021_audit : $CONFAUTOUPDATES"'
    tags:
      - confautoupdates
      - 18.9.102.1
      - eighteen
      - all

  - name: Transfering confautoupdatesday audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/confautoupdatesday_1891022_audit.ps1
      dest: c:\facts\
    tags:
      - confautoupdatesday
      - 18.9.102.2
      - eighteen
      - all

  - name: Adding confautoupdatesday in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$CONFAUTOUPDATESDAY = C:\facts\confautoupdatesday_1891022_audit.ps1'
      - '"confautoupdatesday_1891022_audit : $CONFAUTOUPDATESDAY"'
    tags:
      - confautoupdatesday
      - 18.9.102.2
      - eighteen
      - all

  - name: Transfering noautorestart audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/noautorestart_1891023_audit.ps1
      dest: c:\facts\
    tags:
      - noautorestart
      - 18.9.102.3
      - eighteen
      - all

  - name: Adding noautorestart in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$NOAUTORESTART = C:\facts\noautorestart_1891023_audit.ps1'
      - '"noautorestart_1891023_audit : $NOAUTORESTART"'
    tags:
      - noautorestart
      - 18.9.102.3
      - eighteen
      - all

  - name: Transfering enablescrnsav audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/enablescrnsav_19131_audit.ps1
      dest: c:\facts\
    tags:
      - enablescrnsav
      - nineteen
      - 19.1.3.1
      - all

  - name: Adding enablescrnsav in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$ENABLESCRNSAV = C:\facts\enablescrnsav_19131_audit.ps1'
      - '"enablescrnsav_19131_audit : $ENABLESCRNSAV"'
    tags:
      - enablescrnsav
      - nineteen
      - 19.1.3.1
      - all

  - name: Transfering forspecscrnsav audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/forspecscrnsav_19132_audit.ps1
      dest: c:\facts\
    tags:
      - forspecscrnsav
      - nineteen
      - 19.1.3.2
      - all

  - name: Adding forspecscrnsav in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$FORSPECSCRNSAV = C:\facts\forspecscrnsav_19132_audit.ps1'
      - '"forspecscrnsav_19132_audit : $FORSPECSCRNSAV"'
    tags:
      - forspecscrnsav
      - nineteen
      - 19.1.3.2
      - all

  - name: Transfering passproscrnsav audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/passproscrnsav_19133_audit.ps1
      dest: c:\facts\
    tags:
      - passproscrnsav
      - nineteen
      - 19.1.3.3
      - all

  - name: Adding forspecscrnsav in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PASSPROSCRNSAV = C:\facts\passproscrnsav_19133_audit.ps1'
      - '"passproscrnsav_19133_audit : $PASSPROSCRNSAV"'
    tags:
      - passproscrnsav
      - nineteen
      - 19.1.3.3
      - all

  - name: Transfering scrnsavtimeout audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/scrnsavtimeout_19134_audit.ps1
      dest: c:\facts\
    tags:
      - scrnsavtimeout
      - nineteen
      - 19.1.3.4
      - all

  - name: Adding scrnsavtimeout in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$SCRNSAVTIMEOUT = C:\facts\scrnsavtimeout_19134_audit.ps1'
      - '"scrnsavtimeout_19134_audit : $SCRNSAVTIMEOUT"'
    tags:
      - scrnsavtimeout
      - nineteen
      - 19.1.3.4
      - all

  - name: Transfering toastnotiflockscrn audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/toastnotiflockscrn_19511_audit.ps1
      dest: c:\facts\
    tags:
      - toastnotiflockscrn
      - nineteen
      - 19.5.1.1
      - all

  - name: Adding toastnotiflockscrn in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$TOASTNOTIFLOCKSCRN = C:\facts\toastnotiflockscrn_19511_audit.ps1'
      - '"toastnotiflockscrn_19511_audit : $TOASTNOTIFLOCKSCRN"'
    tags:
      - toastnotiflockscrn
      - nineteen
      - 19.5.1.1
      - all

  - name: Transfering helpexpimprogram audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/helpexpimprogram_196611_audit.ps1
      dest: c:\facts\
    tags:
      - helpexpimprogram
      - nineteen
      - 19.6.6.1.1
      - all

  - name: Adding helpexpimprogram in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$HELPEXPIMPROGRM = C:\facts\helpexpimprogram_196611_audit.ps1'
      - '"helpexpimprogram_196611_audit : $HELPEXPIMPROGRM"'
    tags:
      - helpexpimprogram
      - nineteen
      - 19.6.6.1.1
      - all

  - name: Transfering prezoneinfile audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/prezoneinfile_19741_audit.ps1
      dest: c:\facts\
    tags:
      - prezoneinfile
      - nineteen
      - 19.7.4.1
      - all

  - name: Adding prezoneinfile in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREZONEINFILE = C:\facts\prezoneinfile_19741_audit.ps1'
      - '"prezoneinfile_19741_audit : $PREZONEINFILE"'
    tags:
      - prezoneinfile
      - nineteen
      - 19.7.4.1
      - all

  - name: Transfering notifyantiprogramopen audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/notifyantiprogramopen_19742_audit.ps1
      dest: c:\facts\
    tags:
      - notifyantiprogramopen
      - nineteen
      - 19.7.4.2
      - all

  - name: Adding notifyantiprogramopen in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$NOTIFYANTIPROGRAMPEN = C:\facts\notifyantiprogramopen_19742_audit.ps1'
      - '"notifyantiprogramopen_19742_audit : $NOTIFYANTIPROGRAMPEN"'
    tags:
      - notifyantiprogramopen
      - nineteen
      - 19.7.4.2
      - all

  - name: Transfering prevusersharprof audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/prevusersharprof_197261_audit.ps1
      dest: c:\facts\
    tags:
      - prevusersharprof
      - nineteen
      - 19.7.26.1
      - all

  - name: Adding prevusersharprof in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVUSERSHARPROF = C:\facts\prevusersharprof_197261_audit.ps1'
      - '"prevusersharprof_197261_audit : $PREVUSERSHARPROF"'
    tags:
      - prevusersharprof
      - nineteen
      - 19.7.26.1
      - all

  - name: Transfering installelevprivileg audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/installelevprivileg_197411_audit.ps1
      dest: c:\facts\
    tags:
      - installelevprivileg
      - nineteen
      - 19.7.41.1
      - all

  - name: Adding installelevprivileg in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$INSTALLELEVPRIVILEG = C:\facts\installelevprivileg_197411_audit.ps1'
      - '"installelevprivileg_197411_audit : $INSTALLELEVPRIVILEG"'
    tags:
      - installelevprivileg
      - nineteen
      - 19.7.41.1
      - all

  - name: Transfering prevcodecdown audit file
    win_template:
      src: ../templates/windows_audit/windows2012nonr2/prevcodecdown_1974521_audit.ps1
      dest: c:\facts\
    tags:
      - prevcodecdown
      - nineteen
      - 19.7.45.2.1
      - all

  - name: Adding prevcodecdown in jinjatemplate
    win_lineinfile:
      path: c:\custom_facts\windows2012nonr2.j2.ps1
      line: '{{item}}'
    with_items:
      - '$PREVCODECDOWN = C:\facts\prevcodecdown_1974521_audit.ps1'
      - '"prevcodecdown_1974521_audit : $PREVCODECDOWN"'
    tags:
      - prevcodecdown
      - nineteen
      - 19.7.45.2.1
      - all

  - name: creating a directory for facts storing
    file:
      path: /root/windowscisfacts/
      state: directory
      recurse: yes
    ignore_errors: yes
    delegate_to: localhost
    tags:
      - audit
      
  - name: running setup module
    setup: fact_path='c:\custom_facts'
    register: winfacts
    tags:
      - audit

  - name: saving windows2012nonr2 facts to host specific filenames
    copy:
      content: "{{ winfacts.ansible_facts.ansible_windows2012nonr2 | to_json }}\n"
      dest: "/root/windowscisfacts/audit_{{ansible_hostname}}.json"
      mode: 0666
    when: (ansible_os_name | regex_search('2012 Standard')) or (ansible_os_name | regex_search('2012 Datacenter')) or (ansible_os_name | regex_search('2012 Essentials')) or (ansible_os_name | regex_search('2012 Foundation'))
    failed_when: no
    delegate_to: localhost
    tags:
      - audit

  - name: escaping few characters
    shell: sed -i -e 's;\\;/\\;g' /root/windowscisfacts/audit_{{ansible_hostname}}.json
    delegate_to: localhost
    tags:
      - audit

  - pause: seconds=5
    tags:
      - audit

  - name: removing and replacing colon with additional special characters
    shell: |
        sed -i -e 's/ : /": "/g' /root/windowscisfacts/audit_{{ansible_hostname}}.json
    delegate_to: localhost
    tags:
      - audit

  - pause: seconds=5
    tags:
      - audit

  - name: removing square brackets
    shell: sed -i -e 's/\[//;s/\]//' /root/windowscisfacts/audit_{{ansible_hostname}}.json
    delegate_to: localhost
    tags:
      - audit

  - pause: seconds=5
    tags:
      - audit

  - name: adding flower brackets
    shell: '{{ item }}'
    with_items:
      - sed -i -e 's/^/{/1'  /root/windowscisfacts/audit_{{ansible_hostname}}.json
      - sed -i -e 's/$/}/1' /root/windowscisfacts/audit_{{ansible_hostname}}.json
    delegate_to: localhost
    tags:
      - audit

  - name: Getting the audit json content
    shell: cat /root/windowscisfacts/audit_{{ansible_hostname}}.json
    register: auditfact
    delegate_to: localhost
    tags:
      - audit

  - name: Importing the initial auditfacts values into DB
    community.mysql.mysql_query:
      login_host: "{{ db_host }}"
      login_db: "{{ db }}"
      login_user: "{{ db_user }}"
      login_password: "{{ db_passwd }}"
      query: "UPDATE cis_audit SET audit_result = '{{ auditfact.stdout }}' WHERE id = '{{ id_no }}';"
    delegate_to: localhost
    tags:
      - audit

