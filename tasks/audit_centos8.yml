---
####AUDITFACT####
  - name: RedHat - dependency package [libselinux-python]
    yum: name=libselinux-python state=present
    failed_when: no
    when: ansible_os_family == "RedHat"
    tags:
      - audit

  - name: Removing the existing audit directory
    file:
      path: /etc/ansible/audit.d
      state: absent
    become: yes
    tags:
      - always

  - name: Creating the audit directory
    file:
      path: /etc/ansible/audit.d
      state: directory
      recurse: yes
    become: yes
    tags:
      - always

  - name: Install unzip package
    yum:
      name: unzip
      state: present
    become: yes
    tags:
      - audit
      - all

  - name: unarchiving the audits
    unarchive:
      src: ../templates/linux_audit/centos8/audit.d.zip
      dest: /etc/ansible/
    become: yes
    tags:
      - audit
      - all

  - name: permissions are given to audit files
    shell: chmod 755 /etc/ansible/audit.d/*
    become: yes
    tags:
      - audit
      - all

  - name: Transfering cramfs audit file
    template:
      src: ../templates/linux_audit/centos8/cramfs_1111_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - cramfs
      - 1.1.1.1
      - one
      - all

  - name: Transfering fat audit file
    template:
      src: ../templates/linux_audit/centos8/fat_1112_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - vfat
      - 1.1.1.2
      - one
      - all

  - name: Transfering squashfs audit file
    template:
      src: ../templates/linux_audit/centos8/squashfs_1113_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - squashfs
      - 1.1.1.3
      - one
      - all

  - name: Transfering udf audit file
    template:
      src: ../templates/linux_audit/centos8/udf_1114_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - udf
      - 1.1.1.4
      - one
      - all

  - name: Transfering tmp audit file
    template:
      src: ../templates/linux_audit/centos8/tmp_112_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tmp
      - 1.1.2
      - one
      - all

  - name: Transfering tmpnodev audit file
    template:
      src: ../templates/linux_audit/centos8/tmpnodev_113_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tmpnodev
      - 1.1.3
      - one
      - all

  - name: Transfering tmpnosuid audit file
    template:
      src: ../templates/linux_audit/centos8/tmpnosuid_114_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tmpnosuid
      - 1.1.4
      - one
      - all

  - name: Transfering tmpnoexec audit file
    template:
      src: ../templates/linux_audit/centos8/tmpnoexec_115_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tmpnoexec
      - 1.1.5
      - one
      - all

  - name: Transfering var audit file
    template:
      src: ../templates/linux_audit/centos8/var_116_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - var
      - 1.1.6
      - one
      - all

  - name: Transfering vartmp audit file
    template:
      src: ../templates/linux_audit/centos8/vartmp_117_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - vartmp
      - 1.1.7
      - one
      - all

  - name: Transfering vtnodev audit file
    template:
      src: ../templates/linux_audit/centos8/vtnodev_118_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - vtnodev
      - 1.1.8
      - one
      - all

  - name: Transfering vtnosuid audit file
    template:
      src: ../templates/linux_audit/centos8/vtnosuid_119_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - vtnosuid
      - 1.1.9
      - one
      - all

  - name: Transfering vtnoexec audit file
    template:
      src: ../templates/linux_audit/centos8/vtnoexec_1110_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - vtnoexec
      - 1.1.10
      - one
      - all

  - name: Transfering varlog audit file
    template:
      src: ../templates/linux_audit/centos8/varlog_1111_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - varlog
      - 1.1.11
      - one
      - all

  - name: Transfering varlogaudit audit file
    template:
      src: ../templates/linux_audit/centos8/varlogaudit_1112_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - varlogaudit
      - 1.1.12
      - one
      - all

  - name: Transfering home audit file
    template:
      src: ../templates/linux_audit/centos8/home_1113_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - home
      - 1.1.13
      - one
      - all

  - name: Transfering homenodev audit file
    template:
      src: ../templates/linux_audit/centos8/homenodev_1114_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - homenodev
      - 1.1.14
      - one
      - all

  - name: Transfering shmnodev audit file
    template:
      src: ../templates/linux_audit/centos8/shmnodev_1115_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - shmnodev
      - 1.1.15
      - one
      - all

  - name: Transfering shmnosuid audit file
    template:
      src: ../templates/linux_audit/centos8/shmnosuid_1116_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - shmnosuid
      - 1.1.16
      - one
      - all

  - name: Transfering shmnoexec audit file
    template:
      src: ../templates/linux_audit/centos8/shmnoexec_1117_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - shmnoexec
      - 1.1.17
      - one
      - all

  - name: Transfering medianodev audit file
    template:
      src: ../templates/linux_audit/centos6/medianodev_1118_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - medianodev
      - 1.1.18
      - one
      - all

  - name: Transfering medianosuid audit file
    template:
      src: ../templates/linux_audit/centos6/medianosuid_1119_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - medianosuid
      - 1.1.19
      - one
      - all

  - name: Transfering medianoexec audit file
    template:
      src: ../templates/linux_audit/centos6/medianoexec_1120_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - medianoexec
      - 1.1.20
      - one
      - all

  - name: Transfering stickybit audit file
    template:
      src: ../templates/linux_audit/centos8/stickybit_1121_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - stickybit
      - 1.1.21
      - one
      - all

  - name: Transfering automount audit file
    template:
      src: ../templates/linux_audit/centos8/automount_1122_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - automount
      - 1.1.22
      - one
      - all

  - name: Transfering usbstorage audit file
    template:
      src: ../templates/linux_audit/centos8/usbstorage_1123_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - usbstorage
      - 1.1.23
      - one
      - all

  - name: Transfering gpgkey audit file
    template:
      src: ../templates/linux_audit/centos8/gpgkey_121_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - gpgkey
      - 1.2.1
      - one
      - all

  - name: Transfering gpgcheck audit file
    template:
      src: ../templates/linux_audit/centos8/gpgcheck_122_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - gpgcheck
      - 1.2.2
      - one
      - all

  - name: Transfering repoconfig audit file
    template:
      src: ../templates/linux_audit/centos8/repoconfig_123_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.2.3
      - repoconfig
      - one
      - all

  - name: Transfering sudo audit file
    template:
      src: ../templates/linux_audit/centos8/sudo_131_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sudo
      - 1.3.1
      - one
      - all

  - name: Transfering sudopty audit file
    template:
      src: ../templates/linux_audit/centos8/sudopty_132_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sudopty
      - 1.3.2
      - one
      - all

  - name: Transfering sudologfiles audit file
    template:
      src: ../templates/linux_audit/centos8/sudologfiles_133_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sudologfiles
      - 1.3.3
      - one
      - all

  - name: Transfering aide audit file
    template:
      src: ../templates/linux_audit/centos8/aide_141_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - aide
      - 1.4.1
      - one
      - all

  - name: Transfering fsintegrity audit file
    template:
      src: ../templates/linux_audit/centos8/fsintegrity_142_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.4.2
      - fsintegrity
      - one
      - all

  - name: Transfering bootloadperm audit file
    template:
      src: ../templates/linux_audit/centos8/bootloadperm_151_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - bootloadperm
      - 1.5.1
      - one
      - all

  - name: Transfering bootloadpass audit file
    template:
      src: ../templates/linux_audit/centos8/bootloadpass_152_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - bootloadpass
      - 1.5.2
      - one
      - all

  - name: Transfering singleusermode audit file
    template:
      src: ../templates/linux_audit/centos8/singleusermode_153_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - singleusermode
      - 1.5.3
      - one
      - all

  - name: Transfering coredumps audit file
    template:
      src: ../templates/linux_audit/centos8/coredumps_161_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - coredumps
      - 1.6.1
      - one
      - all

  - name: Transfering aslr audit file
    template:
      src: ../templates/linux_audit/centos8/aslr_162_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - aslr
      - 1.6.2
      - one
      - all

  - name: Transfering selinux audit file
    template:
      src: ../templates/linux_audit/centos8/selinux_1711_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - selinux
      - 1.7.1.1
      - one
      - all

  - name: Transfering seldisable audit file
    template:
      src: ../templates/linux_audit/centos8/seldisable_1712_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - seldisable
      - 1.7.1.2
      - one
      - all

  - name: Transfering selpolicy audit file
    template:
      src: ../templates/linux_audit/centos8/selpolicy_1713_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - selpolicy
      - 1.7.1.3
      - one
      - all

  - name: Transfering selstate audit file
    template:
      src: ../templates/linux_audit/centos8/selstate_1714_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - selstate
      - 1.7.1.4
      - one
      - all

  - name: Transfering unconfined audit file
    template:
      src: ../templates/linux_audit/centos8/unconfined_1715_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - unconfined
      - 1.7.1.5
      - one
      - all

  - name: Transfering setroubleshoot audit file
    template:
      src: ../templates/linux_audit/centos8/setroubleshoot_1716_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - setroubleshoot
      - 1.7.1.6
      - one
      - all

  - name: Transfering mcs audit file
    template:
      src: ../templates/linux_audit/centos8/mcs_1717_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.7.1.7
      - mcs
      - one
      - all

  - name: Transfering msgday audit file
    template:
      src: ../templates/linux_audit/centos8/msgday_1811_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.1.1
      - msgday
      - one
      - all

  - name: Transfering locallogin audit file
    template:
      src: ../templates/linux_audit/centos8/locallogin_1812_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.1.2
      - locallogin
      - one
      - all

  - name: Transfering remotelogin audit file
    template:
      src: ../templates/linux_audit/centos8/remotelogin_1813_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.1.3
      - remotelogin
      - one
      - all

  - name: Transfering motdperm audit file
    template:
      src: ../templates/linux_audit/centos8/motdperm_1814_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.1.4
      - motdperm
      - one
      - all

  - name: Transfering issueperm audit file
    template:
      src: ../templates/linux_audit/centos8/issueperm_1815_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.1.5
      - issueperm
      - one
      - all

  - name: Transfering issuenetperm audit file
    template:
      src: ../templates/linux_audit/centos8/issuenetperm_1816_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.1.6
      - issuenetperm
      - one
      - all

  - name: Transfering gdm audit file
    template:
      src: ../templates/linux_audit/centos8/gdm_182_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 1.8.2
      - gdm
      - one
      - all

  - name: Transfering updates audit file
    template:
      src: ../templates/linux_audit/centos8/updates_19_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - '1.9'
      - updates
      - one
      - all

  - name: Transfering crypolicy audit file
    template:
      src: ../templates/linux_audit/centos8/crypolicy_110_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - '1.10'
      - crypolicy
      - one
      - all

  - name: Transfering crypolicyfuture audit file
    template:
      src: ../templates/linux_audit/centos8/crypolicyfuture_111_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - '1.11'
      - crypolicyfuture
      - one
      - all

  - name: Transfering xinetd audit file
    template:
      src: ../templates/linux_audit/centos8/xinetd_211_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.1.1
      - xinetd
      - two
      - all

  - name: Transfering timesync audit file
    template:
      src: ../templates/linux_audit/centos8/timesync_2211_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.1.1
      - timesync
      - two
      - all

  - name: Transfering chrony audit file
    template:
      src: ../templates/linux_audit/centos8/chrony_2212_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.1.2
      - chrony
      - two
      - all

  - name: Transfering xorg audit file
    template:
      src: ../templates/linux_audit/centos8/xorg_222_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.2
      - xorg
      - two
      - all

  - name: Transfering rsync audit file
    template:
      src: ../templates/linux_audit/centos8/rsync_223_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - two
      - 2.2.3
      - rsync
      - all

  - name: Transfering avahi audit file
    template:
      src: ../templates/linux_audit/centos8/avahi_224_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.4
      - avahi
      - two
      - all

  - name: Transfering snmp audit file
    template:
      src: ../templates/linux_audit/centos8/snmp_225_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.5
      - snmp
      - two
      - all

  - name: Transfering proxy audit file
    template:
      src: ../templates/linux_audit/centos8/proxy_226_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.6
      - proxy
      - two
      - all

  - name: Transfering samba audit file
    template:
      src: ../templates/linux_audit/centos8/samba_227_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.7
      - samba
      - two
      - all

  - name: Transfering imap audit file
    template:
      src: ../templates/linux_audit/centos8/imap_228_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.8
      - imap
      - two
      - all

  - name: Transfering http audit file
    template:
      src: ../templates/linux_audit/centos8/http_229_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.9
      - http
      - two
      - all

  - name: Transfering ftp audit file
    template:
      src: ../templates/linux_audit/centos8/ftp_2210_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.10
      - ftp
      - two
      - all

  - name: Transfering dns audit file
    template:
      src: ../templates/linux_audit/centos8/dns_2211_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.11
      - dns
      - two
      - all

  - name: Transfering nfs audit file
    template:
      src: ../templates/linux_audit/centos8/nfs_2212_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.12
      - nfs
      - two
      - all

  - name: Transfering rpc audit file
    template:
      src: ../templates/linux_audit/centos8/rpc_2213_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.13
      - rpc
      - two
      - all

  - name: Transfering ldap audit file
    template:
      src: ../templates/linux_audit/centos8/ldap_2214_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - two
      - 2.2.14
      - ldap
      - all

  - name: Transfering dhcp audit file
    template:
      src: ../templates/linux_audit/centos8/dhcp_2215_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - two
      - 2.2.15
      - dhcp
      - all

  - name: Transfering cups audit file
    template:
      src: ../templates/linux_audit/centos8/cups_2216_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.16
      - cups
      - two
      - all

  - name: Transfering nis audit file
    template:
      src: ../templates/linux_audit/centos8/nis_2217_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.17
      - nis
      - two
      - all

  - name: Transfering mail audit file
    template:
      src: ../templates/linux_audit/centos8/mail_2218_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.2.18
      - mail
      - two
      - all

  - name: Transfering nisc audit file
    template:
      src: ../templates/linux_audit/centos8/nisc_231_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - two
      - 2.3.1
      - nisc
      - all

  - name: Transfering telnetc audit file
    template:
      src: ../templates/linux_audit/centos8/telnetc_232_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 2.3.2
      - telnetc
      - two
      - all

  - name: Transfering ldapc audit file
    template:
      src: ../templates/linux_audit/centos8/ldapc_233_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - two
      - 2.3.3
      - ldapc
      - all

  - name: Transfering ipforward audit file
    template:
      src: ../templates/linux_audit/centos8/ipforward_311_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipforward
      - 3.1.1
      - three
      - all

  - name: Transfering packetredirect audit file
    template:
      src: ../templates/linux_audit/centos8/packetredirect_312_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - packetredirect
      - 3.1.2
      - three
      - all

  - name: Transfering routedpacket audit file
    template:
      src: ../templates/linux_audit/centos8/routedpacket_321_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - routedpacket
      - 3.2.1
      - three
      - all

  - name: Transfering icmp audit file
    template:
      src: ../templates/linux_audit/centos8/icmp_322_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - icmp
      - 3.2.2
      - three
      - all

  - name: Transfering secureicmp audit file
    template:
      src: ../templates/linux_audit/centos8/secureicmp_323_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - secureicmp
      - 3.2.3
      - three
      - all

  - name: Transfering suspicious audit file
    template:
      src: ../templates/linux_audit/centos8/suspicious_324_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - suspicious
      - 3.2.4
      - three
      - all

  - name: Transfering broadcasticmp audit file
    template:
      src: ../templates/linux_audit/centos8/broadcasticmp_325_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - broadcasticmp
      - 3.2.5
      - three
      - all

  - name: Transfering bogusicmp audit file
    template:
      src: ../templates/linux_audit/centos8/bogusicmp_326_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - bogusicmp
      - 3.2.6
      - three
      - all

  - name: Transfering reversepathfilter audit file
    template:
      src: ../templates/linux_audit/centos8/reversepathfilter_327_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - reversepathfilter
      - 3.2.7
      - three
      - all

  - name: Transfering tcpsyncookies audit file
    template:
      src: ../templates/linux_audit/centos8/tcpsyncookies_328_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tcpsyncookies
      - 3.2.8
      - three
      - all

  - name: Transfering ipv6router audit file
    template:
      src: ../templates/linux_audit/centos8/ipv6router_329_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipv6router
      - 3.2.9
      - three
      - all

  - name: Transfering dccp audit file
    template:
      src: ../templates/linux_audit/centos8/dccp_331_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - dccp
      - 3.3.1
      - three
      - all

  - name: Transfering sctp audit file
    template:
      src: ../templates/linux_audit/centos8/sctp_332_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sctp
      - 3.3.2
      - three
      - all

  - name: Transfering rds audit file
    template:
      src: ../templates/linux_audit/centos8/rds_333_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rds
      - 3.3.3
      - three
      - all

  - name: Transfering tipc audit file
    template:
      src: ../templates/linux_audit/centos8/tipc_334_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tipc
      - 3.3.4
      - three
      - all

  - name: Transfering firewallpack audit file
    template:
      src: ../templates/linux_audit/centos8/firewallpack_3411_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - firewallpack
      - 3.4.1.1
      - three
      - all

  - name: Transfering firewallenb audit file
    template:
      src: ../templates/linux_audit/centos8/firewallenb_3421_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - firewallenb
      - 3.4.2.1
      - three
      - all

  - name: Transfering nftables audit file
    template:
      src: ../templates/linux_audit/centos8/nftables_3422_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nftables
      - 3.4.2.2
      - three
      - all

  - name: Transfering defaultzone audit file
    template:
      src: ../templates/linux_audit/centos8/defaultzone_3423_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - defaultzone
      - 3.4.2.3
      - three
      - all

  - name: Transfering netinterface audit file
    template:
      src: ../templates/linux_audit/centos8/netinterface_3424_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - netinterface
      - 3.4.2.4
      - three
      - all

  - name: Transfering unnecservport audit file
    template:
      src: ../templates/linux_audit/centos8/unnecservport_3425_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - unnecservport
      - 3.4.2.5
      - three
      - all

  - name: Transfering iptables audit file
    template:
      src: ../templates/linux_audit/centos8/iptables_3426_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - iptables
      - 3.4.2.6
      - three
      - all

  - name: Transfering iptablesflush audit file
    template:
      src: ../templates/linux_audit/centos8/iptablesflush_3431_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - iptablesflush
      - 3.4.3.1
      - three
      - all

  - name: Transfering tablexists audit file
    template:
      src: ../templates/linux_audit/centos8/tablexists_3432_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - tablexists
      - 3.4.3.2
      - three
      - all

  - name: Transfering basechains audit file
    template:
      src: ../templates/linux_audit/centos8/basechains_3433_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - basechains
      - 3.4.3.3
      - three
      - all

  - name: Transfering nfloopbacktraffic audit file
    template:
      src: ../templates/linux_audit/centos8/nfloopbacktraffic_3434_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nfloopbacktraffic
      - 3.4.3.4
      - three
      - all

  - name: Transfering nfoutbound audit file
    template:
      src: ../templates/linux_audit/centos8/nfoutbound_3435_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nfoutbound
      - 3.4.3.5
      - three
      - all

  - name: Transfering nffirewallpolicy audit file
    template:
      src: ../templates/linux_audit/centos8/nffirewallpolicy_3436_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nffirewallpolicy
      - 3.4.3.6
      - three
      - all

  - name: Transfering nftablesenb audit file
    template:
      src: ../templates/linux_audit/centos8/nftablesenb_3437_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nftablesenb
      - 3.4.3.7
      - three
      - all

  - name: Transfering nftablesrules audit file
    template:
      src: ../templates/linux_audit/centos8/nftablesrules_3438_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nftablesrules
      - 3.4.3.8
      - three
      - all

  - name: Transfering firewallpolicy audit file
    template:
      src: ../templates/linux_audit/centos8/firewallpolicy_34411_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - firewallpolicy
      - 3.4.4.1.1
      - three
      - all

  - name: Transfering loopbacktraffic audit file
    template:
      src: ../templates/linux_audit/centos8/loopbacktraffic_34412_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - loopbacktraffic
      - 3.4.4.1.2
      - three
      - all

  - name: Transfering outbound audit file
    template:
      src: ../templates/linux_audit/centos8/outbound_34413_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - outbound
      - 3.4.4.1.3
      - three
      - all

  - name: Transfering firewallrules audit file
    template:
      src: ../templates/linux_audit/centos8/firewallrules_34414_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - firewallrules
      - 3.4.4.1.4
      - three
      - all

  - name: Transfering ipv6firewallpolicy audit file
    template:
      src: ../templates/linux_audit/centos8/ipv6firewallpolicy_34421_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipv6firewallpolicy
      - 3.4.4.2.1
      - three
      - all

  - name: Transfering ipv6loopbacktraffic audit file
    template:
      src: ../templates/linux_audit/centos8/ipv6loopbacktraffic_34422_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipv6loopbacktraffic
      - 3.4.4.2.2
      - three
      - all

  - name: Transfering ipv6outbound audit file
    template:
      src: ../templates/linux_audit/centos8/ipv6outbound_34423_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipv6outbound
      - 3.4.4.2.3
      - three
      - all

  - name: Transfering ipv6firewallrules audit file
    template:
      src: ../templates/linux_audit/centos8/ipv6firewallrules_34424_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipv6firewallrules
      - 3.4.4.2.4
      - three
      - all

  - name: Transfering wireless audit file
    template:
      src: ../templates/linux_audit/centos8/wireless_35_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - wireless
      - '3.5'
      - three
      - all

  - name: Transfering ipv6disable audit file
    template:
      src: ../templates/linux_audit/centos8/ipv6disable_36_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ipv6disable
      - '3.6'
      - three
      - all

  - name: Transfering auditd audit file
    template:
      src: ../templates/linux_audit/centos8/auditd_4111_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.1.1
      - four
      - all

  - name: Transfering auditdservice audit file
    template:
      src: ../templates/linux_audit/centos8/auditdservice_4112_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.1.2
      - four
      - all

  - name: Transfering auditdenable audit file
    template:
      src: ../templates/linux_audit/centos8/auditdenable_4113_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.1.3
      - four
      - all

  - name: Transfering auditdbacklog audit file
    template:
      src: ../templates/linux_audit/centos8/auditdbacklog_4114_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.1.4
      - four
      - all

  - name: Transfering auditlogsize audit file
    template:
      src: ../templates/linux_audit/centos8/auditlogsize_4121_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.2.1
      - four
      - all

  - name: Transfering auditlogdelete audit file
    template:
      src: ../templates/linux_audit/centos8/auditlogdelete_4122_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.2.2
      - four
      - all

  - name: Transfering sysdisable audit file
    template:
      src: ../templates/linux_audit/centos8/sysdisable_4123_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sysdisable
      - 4.1.2.3
      - four
      - all

  - name: Transfering sudoers audit file
    template:
      src: ../templates/linux_audit/centos8/sudoers_413_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sudoers
      - 4.1.3
      - four
      - all

  - name: Transfering loginout audit file
    template:
      src: ../templates/linux_audit/centos8/loginout_414_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - loginout
      - 4.1.4
      - four
      - all

  - name: Transfering session audit file
    template:
      src: ../templates/linux_audit/centos8/session_415_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - session
      - 4.1.5
      - four
      - all

  - name: Transfering moddatetime audit file
    template:
      src: ../templates/linux_audit/centos8/moddatetime_416_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - moddatetime
      - 4.1.6
      - four
      - all

  - name: Transfering modsysmac audit file
    template:
      src: ../templates/linux_audit/centos8/modsysmac_417_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - modsysmac
      - 4.1.7
      - four
      - all

  - name: Transfering modsysnet audit file
    template:
      src: ../templates/linux_audit/centos8/modsysnet_418_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - modsysnet
      - 4.1.8
      - four
      - all

  - name: Transfering dacperm audit file
    template:
      src: ../templates/linux_audit/centos8/dacperm_419_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - dacperm
      - 4.1.9
      - four
      - all

  - name: Transfering fileaccess audit file
    template:
      src: ../templates/linux_audit/centos8/fileaccess_4110_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - fileaccess
      - 4.1.10
      - four
      - all

  - name: Transfering modusergrp audit file
    template:
      src: ../templates/linux_audit/centos8/modusergrp_4111_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - modusergrp
      - 4.1.11
      - four
      - all

  - name: Transfering fsmount audit file
    template:
      src: ../templates/linux_audit/centos8/fsmount_4112_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - fsmount
      - 4.1.12
      - four
      - all

  - name: Transfering privilegecmd audit file
    template:
      src: ../templates/linux_audit/centos8/privilegecmd_4113_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - privilegecmd
      - 4.1.13
      - four
      - all

  - name: Transfering filedeletion audit file
    template:
      src: ../templates/linux_audit/centos8/filedeletion_4114_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - filedeletion
      - 4.1.14
      - four
      - all

  - name: Transfering kernelmodule audit file
    template:
      src: ../templates/linux_audit/centos8/kernelmodule_4115_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - kernelmodule
      - 4.1.15
      - four
      - all

  - name: Transfering sudolog audit file
    template:
      src: ../templates/linux_audit/centos8/sudolog_4116_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sudolog
      - 4.1.16
      - four
      - all

  - name: Transfering auditconfig audit file
    template:
      src: ../templates/linux_audit/centos8/auditconfig_4117_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 4.1.17
      - four
      - all

  - name: Transfering rsyslog audit file
    template:
      src: ../templates/linux_audit/centos8/rsyslog_4211_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rsyslog
      - 4.2.1.1
      - four
      - all

  - name: Transfering rsyslogenb audit file
    template:
      src: ../templates/linux_audit/centos8/rsyslogenb_4212_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rsyslogenb
      - 4.2.1.2
      - four
      - all

  - name: Transfering rsyslogperm audit file
    template:
      src: ../templates/linux_audit/centos8/rsyslogperm_4213_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rsyslogperm
      - 4.2.1.3
      - four
      - all

  - name: Transfering rloggingconf audit file
    template:
      src: ../templates/linux_audit/centos8/rloggingconf_4214_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rloggingconf
      - 4.2.1.4
      - four
      - all

  - name: Transfering rsyslogsendlogs audit file
    template:
      src: ../templates/linux_audit/centos8/rsyslogsendlogs_4215_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rsyslogsendlogs
      - 4.2.1.5
      - four
      - all

  - name: Transfering remotesyslogmsg audit file
    template:
      src: ../templates/linux_audit/centos8/remotesyslogmsg_4216_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - remotesyslogmsg
      - 4.2.1.6
      - four
      - all

  - name: Transfering journalsendlogs audit file
    template:
      src: ../templates/linux_audit/centos8/journalsendlogs_4221_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - journalsendlogs
      - 4.2.2.1
      - four
      - all

  - name: Transfering journalcompresslog audit file
    template:
      src: ../templates/linux_audit/centos8/journalcompresslog_4222_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - journalcompresslog
      - 4.2.2.2
      - four
      - all

  - name: Transfering journalpersisdisk audit file
    template:
      src: ../templates/linux_audit/centos8/journalpersisdisk_4223_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - journalpersisdisk
      - 4.2.2.3
      - four
      - all

  - name: Transfering permlogfiles audit file
    template:
      src: ../templates/linux_audit/centos8/permlogfiles_423_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permlogfiles
      - 4.2.3
      - four
      - all

  - name: Transfering logrotate audit file
    template:
      src: ../templates/linux_audit/centos8/logrotate_43_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - logrotate
      - '4.3'
      - four
      - all

  - name: Transfering cron audit file
    template:
      src: ../templates/linux_audit/centos8/cron_511_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - cron
      - 5.1.1
      - five
      - all

  - name: Transfering permcrontab audit file
    template:
      src: ../templates/linux_audit/centos8/permcrontab_512_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permcrontab
      - 5.1.2
      - five
      - all

  - name: Transfering permcronhourly audit file
    template:
      src: ../templates/linux_audit/centos8/permcronhourly_513_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permcronhourly
      - 5.1.3
      - five
      - all

  - name: Transfering permcrondaily audit file
    template:
      src: ../templates/linux_audit/centos8/permcrondaily_514_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permcrondaily
      - 5.1.4
      - five
      - all

  - name: Transfering permcronweekly audit file
    template:
      src: ../templates/linux_audit/centos8/permcronweekly_515_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permcronweekly
      - 5.1.5
      - five
      - all

  - name: Transfering permcronmonthly audit file
    template:
      src: ../templates/linux_audit/centos8/permcronmonthly_516_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permcronmonthly
      - 5.1.6
      - five
      - all

  - name: Transfering permcrond audit file
    template:
      src: ../templates/linux_audit/centos8/permcrond_517_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permcrond
      - 5.1.7
      - five
      - all

  - name: Transfering atcron audit file
    template:
      src: ../templates/linux_audit/centos8/atcron_518_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - atcron
      - 5.1.8
      - five
      - all

  - name: Transfering sshdperm audit file
    template:
      src: ../templates/linux_audit/centos8/sshdperm_521_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshdperm
      - 5.2.1
      - five
      - all

  - name: Transfering sshaccess audit file
    template:
      src: ../templates/linux_audit/centos8/sshaccess_522_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshaccess
      - 5.2.2
      - five
      - all

  - name: Transfering sshpermpvtkey audit file
    template:
      src: ../templates/linux_audit/centos8/sshpermpvtkey_523_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshpermpvtkey
      - 5.2.3
      - five
      - all

  - name: Transfering sshpermpubkey audit file
    template:
      src: ../templates/linux_audit/centos8/sshpermpubkey_524_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshpermpubkey
      - 5.2.4
      - five
      - all

  - name: Transfering sshloglevel audit file
    template:
      src: ../templates/linux_audit/centos8/sshloglevel_525_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshloglevel
      - 5.2.5
      - five
      - all

  - name: Transfering sshx11forward audit file
    template:
      src: ../templates/linux_audit/centos8/sshx11forward_526_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshx11forward
      - 5.2.6
      - five
      - all

  - name: Transfering sshmaxauthtries audit file
    template:
      src: ../templates/linux_audit/centos8/sshmaxauthtries_527_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshmaxauthtries
      - 5.2.7
      - five
      - all

  - name: Transfering sshignorerhosts audit file
    template:
      src: ../templates/linux_audit/centos8/sshignorerhosts_528_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshignorerhosts
      - 5.2.8
      - five
      - all

  - name: Transfering sshauthentication audit file
    template:
      src: ../templates/linux_audit/centos8/sshauthentication_529_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshauthentication
      - 5.2.9
      - five
      - all

  - name: Transfering sshrootlogin audit file
    template:
      src: ../templates/linux_audit/centos8/sshrootlogin_5210_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshrootlogin
      - 5.2.10
      - five
      - all

  - name: Transfering sshpep audit file
    template:
      src: ../templates/linux_audit/centos8/sshpep_5211_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshpep
      - 5.2.11
      - five
      - all

  - name: Transfering sshpue audit file
    template:
      src: ../templates/linux_audit/centos8/sshpue_5212_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshpue
      - 5.2.12
      - five
      - all

  - name: Transfering sshidletimeout audit file
    template:
      src: ../templates/linux_audit/centos8/sshidletimeout_5213_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshidletimeout
      - 5.2.13
      - five
      - all

  - name: Transfering sshlogingracetime audit file
    template:
      src: ../templates/linux_audit/centos8/sshlogingracetime_5214_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshlogingracetime
      - 5.2.14
      - five
      - all

  - name: Transfering sshwarningbanner audit file
    template:
      src: ../templates/linux_audit/centos8/sshwarningbanner_5215_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshwarningbanner
      - 5.2.15
      - five
      - all

  - name: Transfering sshpam audit file
    template:
      src: ../templates/linux_audit/centos8/sshpam_5216_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshpam
      - 5.2.16
      - five
      - all

  - name: Transfering sshtcpforward audit file
    template:
      src: ../templates/linux_audit/centos8/sshtcpforward_5217_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshtcpforward
      - 5.2.17
      - five
      - all

  - name: Transfering sshmaxstartups audit file
    template:
      src: ../templates/linux_audit/centos8/sshmaxstartups_5218_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshmaxstartups
      - 5.2.18
      - five
      - all

  - name: Transfering sshmaxsessions audit file
    template:
      src: ../templates/linux_audit/centos8/sshmaxsessions_5219_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshmaxsessions
      - 5.2.19
      - five
      - all

  - name: Transfering sshsyscrytopolicy audit file
    template:
      src: ../templates/linux_audit/centos8/sshsyscrytopolicy_5220_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sshsyscrytopolicy
      - 5.2.20
      - five
      - all

  - name: Transfering authselect audit file
    template:
      src: ../templates/linux_audit/centos8/authselect_531_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - authselect
      - 5.3.1
      - five
      - all

  - name: Transfering authselectprofile audit file
    template:
      src: ../templates/linux_audit/centos8/authselectprofile_532_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - authselectprofile
      - 5.3.2
      - five
      - all

  - name: Transfering authselectfaillock audit file
    template:
      src: ../templates/linux_audit/centos8/authselectfaillock_533_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - authselectfaillock
      - 5.3.3
      - five
      - all

  - name: Transfering passwdcreation audit file
    template:
      src: ../templates/linux_audit/centos8/passwdcreation_541_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - passwdcreation
      - 5.4.1
      - five
      - all

  - name: Transfering lockout audit file
    template:
      src: ../templates/linux_audit/centos8/lockout_542_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - lockout
      - 5.4.2
      - five
      - all

  - name: Transfering passwdreuse audit file
    template:
      src: ../templates/linux_audit/centos8/passwdreuse_543_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - passwdreuse
      - 5.4.3
      - five
      - all

  - name: Transfering passwdhashing audit file
    template:
      src: ../templates/linux_audit/centos8/passwdhashing_544_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - passwdhashing
      - 5.4.4
      - five
      - all

  - name: Transfering passwdexpiration audit file
    template:
      src: ../templates/linux_audit/centos8/passwdexpiration_5511_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - passwdexpiration
      - 5.5.1.1
      - five
      - all

  - name: Transfering minidays audit file
    template:
      src: ../templates/linux_audit/centos8/minidays_5512_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - minidays
      - 5.5.1.2
      - five
      - all

  - name: Transfering warningdays audit file
    template:
      src: ../templates/linux_audit/centos8/warningdays_5513_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - warningdays
      - 5.5.1.3
      - five
      - all

  - name: Transfering inactivepasswdlock audit file
    template:
      src: ../templates/linux_audit/centos8/inactivepasswdlock_5514_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - inactivepasswdlock
      - 5.5.1.4
      - five
      - all

  - name: Transfering lastpasswdchange audit file
    template:
      src: ../templates/linux_audit/centos8/lastpasswdchange_5515_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - lastpasswdchange
      - 5.5.1.5
      - five
      - all

  - name: Transfering sysacclogin audit file
    template:
      src: ../templates/linux_audit/centos8/sysacclogin_552_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sysacclogin
      - 5.5.2
      - five
      - all

  - name: Transfering usershelltimeout audit file
    template:
      src: ../templates/linux_audit/centos8/usershelltimeout_553_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - usershelltimeout
      - 5.5.3
      - five
      - all

  - name: Transfering defaultgroup audit file
    template:
      src: ../templates/linux_audit/centos8/defaultgroup_554_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - defaultgroup
      - 5.5.4
      - five
      - all

  - name: Transfering defaultuser audit file
    template:
      src: ../templates/linux_audit/centos8/defaultuser_555_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - defaultuser
      - 5.5.5
      - five
      - all

  - name: Transfering rootlogin audit file
    template:
      src: ../templates/linux_audit/centos8/rootlogin_56_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rootlogin
      - '5.6'
      - five
      - all

  - name: Transfering suaccess audit file
    template:
      src: ../templates/linux_audit/centos8/suaccess_57_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - suaccess
      - '5.7'
      - five
      - all

  - name: Transfering auditsysperm audit file
    template:
      src: ../templates/linux_audit/centos8/auditsysperm_611_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - 6.1.1
      - six
      - all

  - name: Transfering permpasswd audit file
    template:
      src: ../templates/linux_audit/centos8/permpasswd_612_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permpasswd
      - 6.1.2
      - six
      - all

  - name: Transfering permshadow audit file
    template:
      src: ../templates/linux_audit/centos8/permshadow_613_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permshadow
      - 6.1.3
      - six
      - all

  - name: Transfering permgroup audit file
    template:
      src: ../templates/linux_audit/centos8/permgroup_614_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permgroup
      - 6.1.4
      - six
      - all

  - name: Transfering permgshadow audit file
    template:
      src: ../templates/linux_audit/centos8/permgshadow_615_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permgshadow
      - 6.1.5
      - six
      - all

  - name: Transfering permpasswdi audit file
    template:
      src: ../templates/linux_audit/centos8/permpasswdi_616_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permpasswdi
      - 6.1.6
      - six
      - all

  - name: Transfering permshadowi audit file
    template:
      src: ../templates/linux_audit/centos8/permshadowi_617_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permshadowi
      - 6.1.7
      - six
      - all

  - name: Transfering permgroupi audit file
    template:
      src: ../templates/linux_audit/centos8/permgroupi_618_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permgroupi
      - 6.1.8
      - six
      - all

  - name: Transfering permgshadowi audit file
    template:
      src: ../templates/linux_audit/centos8/permgshadowi_619_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - permgshadowi
      - 6.1.9
      - six
      - all

  - name: Transfering wwfiles audit file
    template:
      src: ../templates/linux_audit/centos8/wwfiles_6110_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - wwfiles
      - 6.1.10
      - six
      - all

  - name: Transfering unownedfiles audit file
    template:
      src: ../templates/linux_audit/centos8/unownedfiles_6111_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - unownedfiles
      - 6.1.11
      - six
      - all

  - name: Transfering ungroupedfiles audit file
    template:
      src: ../templates/linux_audit/centos8/ungroupedfiles_6112_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - ungroupedfiles
      - 6.1.12
      - six
      - all

  - name: Transfering suidexec audit file
    template:
      src: ../templates/linux_audit/centos8/suidexec_6113_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - suidexec
      - 6.1.13
      - six
      - all

  - name: Transfering sgidexec audit file
    template:
      src: ../templates/linux_audit/centos8/sgidexec_6114_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - sgidexec
      - 6.1.14
      - six
      - all

  - name: Transfering emptypasswd audit file
    template:
      src: ../templates/linux_audit/centos8/emptypasswd_621_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - emptypasswd
      - 6.2.1
      - six
      - all

  - name: Transfering nolegacypasswd audit file
    template:
      src: ../templates/linux_audit/centos8/nolegacypasswd_622_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nolegacypasswd
      - 6.2.2
      - six
      - all

  - name: Transfering rootpath audit file
    template:
      src: ../templates/linux_audit/centos8/rootpath
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rootpath
      - 6.2.3
      - six
      - all

  - name: Transfering nolegacyshadow audit file
    template:
      src: ../templates/linux_audit/centos8/nolegacyshadow_624_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nolegacyshadow
      - 6.2.4
      - six
      - all

  - name: Transfering nolegacygroup audit file
    template:
      src: ../templates/linux_audit/centos8/nolegacygroup_625_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - nolegacygroup
      - 6.2.5
      - six
      - all

  - name: Transfering rootuid audit file
    template:
      src: ../templates/linux_audit/centos8/rootuid_626_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rootuid
      - 6.2.6
      - six
      - all

  - name: Transfering userhdirperm audit file
    template:
      src: ../templates/linux_audit/centos8/userhdirperm_627_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - userhdirperm
      - 6.2.7
      - six
      - all

  - name: Transfering userownhdir audit file
    template:
      src: ../templates/linux_audit/centos8/userownhdir_628_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - userownhdir
      - 6.2.8
      - six
      - all

  - name: Transfering dotfiles audit file
    template:
      src: ../templates/linux_audit/centos8/dotfiles_629_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - dotfiles
      - 6.2.9
      - six
      - all

  - name: Transfering forwardfiles audit file
    template:
      src: ../templates/linux_audit/centos8/forwardfiles_6210_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - forwardfiles
      - 6.2.10
      - six
      - all

  - name: Transfering netrcfiles audit file
    template:
      src: ../templates/linux_audit/centos8/netrcfiles_6211_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - netrcfiles
      - 6.2.11
      - six
      - all

  - name: Transfering grpnetrcfiles audit file
    template:
      src: ../templates/linux_audit/centos8/grpnetrcfiles_6212_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - grpnetrcfiles
      - 6.2.12
      - six
      - all

  - name: Transfering rhosts audit file
    template:
      src: ../templates/linux_audit/centos8/rhosts_6213_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - rhosts
      - 6.2.13
      - six
      - all

  - name: Transfering groups audit file
    template:
      src: ../templates/linux_audit/centos8/groups_6214_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - groups
      - 6.2.14
      - six
      - all

  - name: Transfering duplicateuid audit file
    template:
      src: ../templates/linux_audit/centos8/duplicateuid_6215_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - duplicateuid
      - 6.2.15
      - six
      - all

  - name: Transfering duplicategid audit file
    template:
      src: ../templates/linux_audit/centos8/duplicategid_6216_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - duplicategid
      - 6.2.16
      - six
      - all

  - name: Transfering duplicateuser audit file
    template:
      src: ../templates/linux_audit/centos8/duplicateuser_6217_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - duplicateuser
      - 6.2.17
      - six
      - all

  - name: Transfering duplicategroup audit file
    template:
      src: ../templates/linux_audit/centos8/duplicategroup_6218_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - duplicategroup
      - 6.2.18
      - six
      - all

  - name: Transfering shadowgroup audit file
    template:
      src: ../templates/linux_audit/centos8/shadowgroup_6219_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - shadowgroup
      - 6.2.19
      - six
      - all

  - name: Transfering userhdir audit file
    template:
      src: ../templates/linux_audit/centos8/userhdir_6220_audit.fact
      dest: /etc/ansible/audit.d/
      mode: 0755
    become: yes
    tags:
      - userhdir
      - 6.2.20
      - six
      - all

  - name: creating a directory for facts storing
    file:
      path: /root/linuxcisfacts/
      state: directory
      recurse: yes
    ignore_errors: yes
    delegate_to: localhost
    tags:
      - audit

  - name: Reloading ansible_local audit facts
    setup: fact_path=/etc/ansible/audit.d
    become: yes
    become_method: sudo
    tags:
      - audit

  - name: saving all facts to host specific filename for audit facts
    copy:
      content: "{{ ansible_local | to_json }}\n"
      dest: "/root/linuxcisfacts/audit_{{ansible_hostname}}.json"
      mode: 0666
    failed_when: no
    become: yes
    delegate_to: localhost
    tags:
      - audit

  - name: Getting the audit json content
    shell: cat /root/linuxcisfacts/audit_{{ansible_hostname}}.json
    register: auditfact
    delegate_to: localhost
    tags:
      - audit

  - name: Importing the initial auditfacts values into DB
    community.mysql.mysql_query:
      login_host: "{{ db_host }}"
      login_db: "{{ db }}"
      login_user: "{{ db_user }}"
      login_password: "{{ db_passwd }}"
      query: "UPDATE cis_audit SET audit_result = '{{ auditfact.stdout }}' WHERE id = '{{ id_no }}';"
    delegate_to: localhost
    tags:
      - audit
